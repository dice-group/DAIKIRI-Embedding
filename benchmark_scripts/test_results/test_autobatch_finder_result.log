============================= test session starts ==============================
platform linux -- Python 3.9.12, pytest-6.2.5, py-1.11.0, pluggy-1.0.0 -- /upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/bin/python
cachedir: .pytest_cache
rootdir: /local/upb/users/r/renzhong/profiles/unix/cs/Dicee/dice-embeddings
plugins: anyio-3.6.2
collecting ... collected 39 items

tests/test_trainers.py::TestCallback::test_conex_torch_cpu_trainer PASSED [  2%]
tests/test_trainers.py::TestCallback::test_aconex_pl_trainer FAILED      [  5%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_DistMult] PASSED [  7%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_TuckER] PASSED [ 10%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_UM] PASSED [ 12%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_TransR] PASSED [ 15%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_TransH] PASSED [ 17%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_TransF] PASSED [ 20%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_TransE] PASSED [ 23%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_TransD] PASSED [ 25%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_TorusE] PASSED [ 28%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_SimplE] PASSED [ 30%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_SE] PASSED [ 33%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_RESCAL] PASSED [ 35%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_RotatE] PASSED [ 38%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_QuatE] PASSED [ 41%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_PairRE] PASSED [ 43%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_ProjE] PASSED [ 46%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_NTN] PASSED [ 48%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_NodePiece] FAILED [ 51%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_MuRE] PASSED [ 53%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_KG2E] FAILED [ 56%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_InductiveNodePiece] FAILED [ 58%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_InductiveNodePieceGNN] FAILED [ 61%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_HolE] PASSED [ 64%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_FixedModel] PASSED [ 66%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_ERMLPE] PASSED [ 69%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_DistMA] PASSED [ 71%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_CrossE] PASSED [ 74%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_CooccurrenceFilteredModel] PASSED [ 76%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_ConvKB] PASSED [ 79%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_ConvE] PASSED [ 82%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_ComplExLiteral] FAILED [ 84%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_ComplEx] PASSED [ 87%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_CompGCN] FAILED [ 89%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_CP] PASSED [ 92%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_BoxE] PASSED [ 94%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_AutoSF] PASSED [ 97%]
tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_DistMultLiteral] FAILED [100%]

=================================== FAILURES ===================================
_____________________ TestCallback.test_aconex_pl_trainer ______________________

self = <tests.test_trainers.TestCallback object at 0x7fb256983d90>

    @pytest.mark.filterwarnings('ignore::UserWarning')
    def test_aconex_pl_trainer(self):
        args = Args()  # get_default_arguments([])
        args.model = 'AConEx'
        args.num_epochs = 1
        args.scoring_technique = 'KvsAll'
        args.path_dataset_folder = 'KGs/UMLS'
        args.num_epochs = 10
        args.batch_size = 1024
        args.lr = 0.01
        args.embedding_dim = 32
        args.trainer = 'PL'
>       Execute(args).start()

tests/test_trainers.py:33: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dicee/executer.py:212: in start
    self.trained_model, form_of_labelling = self.trainer.start(dataset=self.dataset)
dicee/trainer/dice_trainer.py:256: in start
    self.trainer.fit(model, train_dataloaders=self.initialize_dataloader(self.initialize_dataset(dataset, form_of_labelling)))
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py:770: in fit
    self._call_and_handle_interrupt(
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py:721: in _call_and_handle_interrupt
    return self.strategy.launcher.launch(trainer_fn, *args, trainer=self, **kwargs)
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py:93: in launch
    return function(*args, **kwargs)
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py:811: in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py:1217: in _run
    self.strategy.setup(self)
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/pytorch_lightning/strategies/ddp.py:159: in setup
    self._share_information_to_prevent_deadlock()
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/pytorch_lightning/strategies/ddp.py:396: in _share_information_to_prevent_deadlock
    self._share_pids()
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/pytorch_lightning/strategies/ddp.py:414: in _share_pids
    pids = self.all_gather(torch.tensor(os.getpid(), device=self.root_device))
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/pytorch_lightning/strategies/parallel.py:111: in all_gather
    return all_gather_ddp_if_available(tensor, group=group, sync_grads=sync_grads)
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/pytorch_lightning/utilities/distributed.py:188: in all_gather_ddp_if_available
    return AllGatherGrad.apply(tensor, group)
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/torch/autograd/function.py:506: in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/pytorch_lightning/utilities/distributed.py:156: in forward
    torch.distributed.all_gather(gathered_tensor, tensor, group=group)
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:1436: in wrapper
    return func(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

tensor_list = [tensor(0)], tensor = tensor(949208)
group = <torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb3050b7f30>
async_op = False

    @exception_handler
    def all_gather(tensor_list, tensor, group=None, async_op=False):
        """
        Gathers tensors from the whole group in a list.
    
        Complex tensors are supported.
    
        Args:
            tensor_list (list[Tensor]): Output list. It should contain
                correctly-sized tensors to be used for output of the collective.
            tensor (Tensor): Tensor to be broadcast from current process.
            group (ProcessGroup, optional): The process group to work on. If None,
                the default process group will be used.
            async_op (bool, optional): Whether this op should be an async op
    
        Returns:
            Async work handle, if async_op is set to True.
            None, if not async_op or if not part of the group
    
        Examples:
            >>> # xdoctest: +SKIP("need process group init")
            >>> # All tensors below are of torch.int64 dtype.
            >>> # We have 2 process groups, 2 ranks.
            >>> tensor_list = [torch.zeros(2, dtype=torch.int64) for _ in range(2)]
            >>> tensor_list
            [tensor([0, 0]), tensor([0, 0])] # Rank 0 and 1
            >>> tensor = torch.arange(2, dtype=torch.int64) + 1 + 2 * rank
            >>> tensor
            tensor([1, 2]) # Rank 0
            tensor([3, 4]) # Rank 1
            >>> dist.all_gather(tensor_list, tensor)
            >>> tensor_list
            [tensor([1, 2]), tensor([3, 4])] # Rank 0
            [tensor([1, 2]), tensor([3, 4])] # Rank 1
    
            >>> # All tensors below are of torch.cfloat dtype.
            >>> # We have 2 process groups, 2 ranks.
            >>> tensor_list = [torch.zeros(2, dtype=torch.cfloat) for _ in range(2)]
            >>> tensor_list
            [tensor([0.+0.j, 0.+0.j]), tensor([0.+0.j, 0.+0.j])] # Rank 0 and 1
            >>> tensor = torch.tensor([1+1j, 2+2j], dtype=torch.cfloat) + 2 * rank * (1+1j)
            >>> tensor
            tensor([1.+1.j, 2.+2.j]) # Rank 0
            tensor([3.+3.j, 4.+4.j]) # Rank 1
            >>> dist.all_gather(tensor_list, tensor)
            >>> tensor_list
            [tensor([1.+1.j, 2.+2.j]), tensor([3.+3.j, 4.+4.j])] # Rank 0
            [tensor([1.+1.j, 2.+2.j]), tensor([3.+3.j, 4.+4.j])] # Rank 1
    
        """
        _check_tensor_list(tensor_list, "tensor_list")
        _check_single_tensor(tensor, "tensor")
        _ensure_all_tensors_same_dtype(tensor_list, tensor)
        if _rank_not_in_group(group):
            _warn_not_in_group("all_gather")
            return
    
        tensor_list = [
            t if not t.is_complex() else torch.view_as_real(t) for t in tensor_list
        ]
        tensor = tensor if not tensor.is_complex() else torch.view_as_real(tensor)
    
        if group is None:
            default_pg = _get_default_group()
            work = default_pg.allgather([tensor_list], [tensor])
        else:
>           work = group.allgather([tensor_list], [tensor])
E           RuntimeError: Tensors must be CUDA and dense

/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:2435: RuntimeError
----------------------------- Captured stdout call -----------------------------
Start time:2023-07-05 20:12:03.339715
*** Read or Load Knowledge Graph  ***
*** Reading KGs/UMLS/test.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0022 seconds | Current Memory Usage  619.67 in MB
*** Reading KGs/UMLS/train.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0042 seconds | Current Memory Usage  619.67 in MB
*** Reading KGs/UMLS/valid.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0015 seconds | Current Memory Usage  619.67 in MB
[3.1 / 14] Add reciprocal triples to train, validation, and test sets, e.g. KG:= {(s,p,o)} union {(o,p_inverse,s)}
Done !


Concatenating data to obtain index...
Done !

Creating a mapping from entities to integer indexes...
Done !

Done ! 0.008 seconds

Done !

Done !

Took 0.0200 seconds | Current Memory Usage  619.67 in MB
Data Type conversion...
Submit er-vocab, re-vocab, and ee-vocab via  ProcessPoolExecutor...
Preprocessing took: 0.052 seconds

------------------- Description of Dataset KGs/UMLS -------------------
Number of entities:135
Number of relations:92
Number of triples on train set:10432
Number of triples on valid set:1304
Number of triples on test set:1322
Entity Index:0.00000 in GB
Relation Index:0.00000 in GB
Train set :0.00006 in GB

# of CPUs:64 | # of GPUs:1 | # of CPUs for dataloader:0
NVIDIA GeForce RTX 3090
------------------- Train -------------------
Initializing Pytorch-lightning Trainer	Took 0.0046 seconds | Current Memory Usage  619.68 in MB
Initializing Model...	Initializing the selected model... Took 0.0021 seconds | Current Memory Usage  619.68 in MB
Initializing Dataset...	Took 0.0105 seconds
Took 0.0110 seconds | Current Memory Usage  619.68 in MB
Took 0.0111 seconds | Current Memory Usage  619.68 in MB
Initializing Dataloader...	Took 0.0001 seconds | Current Memory Usage  619.68 in MB
_____________ TestCallback.test_torchDDP_trainer[Pykeen_NodePiece] _____________

self = <tests.test_trainers.TestCallback object at 0x7fb2568f6940>
model_name = 'Pykeen_NodePiece'

    @pytest.mark.filterwarnings("ignore::UserWarning")
    @pytest.mark.parametrize(
        "model_name",
        [
            "Pykeen_DistMult",
            "Pykeen_TuckER",
            "Pykeen_UM",
            "Pykeen_TransR",
            "Pykeen_TransH",
            "Pykeen_TransF",
            "Pykeen_TransE",
            "Pykeen_TransD",
            "Pykeen_TorusE",
            "Pykeen_SimplE",
            "Pykeen_SE",
            "Pykeen_RESCAL",
            "Pykeen_RotatE",
            "Pykeen_QuatE",
            "Pykeen_PairRE",
            "Pykeen_ProjE",
            "Pykeen_NTN",
            "Pykeen_NodePiece",
            "Pykeen_MuRE",
            "Pykeen_KG2E",
            "Pykeen_InductiveNodePiece",
            "Pykeen_InductiveNodePieceGNN",
            "Pykeen_HolE",
            "Pykeen_FixedModel",
            "Pykeen_ERMLPE",
            "Pykeen_DistMA",
            "Pykeen_CrossE",
            "Pykeen_CooccurrenceFilteredModel",
            "Pykeen_ConvKB",  # this one is really slow
            "Pykeen_ConvE",
            "Pykeen_ComplExLiteral",
            "Pykeen_ComplEx",
            "Pykeen_CompGCN",
            "Pykeen_CP",
            "Pykeen_BoxE",
            "Pykeen_AutoSF",
            "Pykeen_DistMultLiteral",
        ],
    )
    def test_torchDDP_trainer(self, model_name):
      import torch
      args = get_default_arguments([])
      # args.model = 'DistMult'
      # args.model = 'Pykeen_DistMult'
      # args.model = 'Pykeen_KG2E'
      # args.model = 'AConEx'
      args.model = model_name
      # args.scoring_technique = "NegSample"
      args.scoring_technique = 'KvsAll'
      args.path_dataset_folder = "KGs/Nations"
      args.num_epochs = 20
      args.batch_size = 20
      args.lr = 0.01
      args.embedding_dim = 64
      args.trainer = 'torchDDP'
      # args.trainer = "torchCPUTrainer"
      args.num_core = 1  # need to be bigger than 0
      args.eval_model = "test"
      args.normalization = None
      args.devices = "auto"
      args.accelerator = "auto"
      args.optim = "Adam"
      args.pykeen_model_kwargs = dict(
          embedding_dim=args.embedding_dim, loss="BCEWithLogitsLoss"
      )
      args.use_ddp_batch_finder = True
>     Execute(args).start()

tests/test_trainers.py:105: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dicee/executer.py:212: in start
    self.trained_model, form_of_labelling = self.trainer.start(dataset=self.dataset)
dicee/trainer/dice_trainer.py:251: in start
    self.trainer.fit(model,train_dataloaders=model.train_dataloaders)
dicee/trainer/torch_trainer_ddp.py:100: in fit
    final_batch, rest_epoachs = self.find_batch_size(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <dicee.trainer.torch_trainer_ddp.TorchDDPTrainer object at 0x7fb304acf3d0>
model = MyLCWALitModule(
  (model): NodePiece(
    (loss): BCEWithLogitsLoss()
    (interaction): DistMultInteraction()
    (e... Embedding(221, 64)
        )
      )
    )
    (weight_regularizers): ModuleList()
  )
  (loss): BCEWithLogitsLoss()
)
world_size = 1
kwargs = {'train_dataloaders': <torch.utils.data.dataloader.DataLoader object at 0x7fb2f5e618e0>}

    def find_batch_size(self, model, world_size, kwargs):
        # @TODO auto batch size implementation
        oom = False
        batch_size = self.attributes.batch_size  # batch size to increase
        initial_num_epochs = self.attributes.num_epochs
        num_of_try_epochs = 1
        rest_epoachs = 0
        double_counter = 0
        if "train_dataloaders" not in kwargs:
            # get the length of dataset from pykeen
            kwargs["train_dataloaders"] = model.train_dataloaders
            # size_of_train_data = len(model.dataset.training.triples)
    
        size_of_train_data = len(kwargs["train_dataloaders"].dataset)
    
        while not oom and double_counter < 5:
    
            try:
    
                rest_epoachs = initial_num_epochs - num_of_try_epochs
                if num_of_try_epochs == initial_num_epochs:
                    # no rest of epochs are left to test the batch_size or
                    # bacth_size is already bigger than train dataset
                    # oom = False
    
                    return self.attributes.batch_size, rest_epoachs
    
                if self.attributes.batch_size > size_of_train_data:
                    # go to binary search
                    oom = True
                    break
    
                self.attributes.num_epochs = 1  # only run one epoch
    
                # if num_of_try_epochs!=0:
                #   model.load_state_dict(torch.load("model.pt"))
                  # model.load_state_dict(torch.load("model.pt", map_location=torch.device("cpu")))
    
                if num_of_try_epochs != 1:
    
                  self.attributes.batch_size = self.attributes.batch_size*2 # make it faster
    
                self.attributes.num_of_try_epochs = num_of_try_epochs
    
                mp.spawn(
                    fn=distributed_training,
                    args=(
                        world_size,
                        model,
                        kwargs["train_dataloaders"],
                        self.callbacks,
                        self.attributes,
                    ),
                    nprocs=world_size,
                    join=True,
                )
                # model.load_state_dict(
                #     torch.load("model.pt", map_location=torch.device("cpu"))
                # )
                # os.remove("model.pt")
                # self.attributes.batch_size += batch_size  # increase the batch size
                # model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                num_of_try_epochs += 1
                double_counter +=1
    
    
            except Exception:
    
                oom = True
    
        # the batch_size here can be sure to fit in the memory of GPU
        # @TODO: there may be another method to find the batach size after oom
        # if num_of_try_epochs == 0:
        #     raise ValueError(
        #         f"batch_size of {self.attributes.batch_size} is too large or something wrong in the first try!"
        #     )
    
    
        # rest_epoachs = initial_num_epochs - num_of_try_epochs
        # find_flag =False
    
        # oom because of increaseing batch size or the origin batch size is too large
        if oom:
          r = self.attributes.batch_size
          # self.attributes.batch_size += (
          #     -batch_size
          # )  # reset the batch size to the last add
    
          self.attributes.batch_size = self.attributes.batch_size//2 # reset back to the old batch size
    
          l = self.attributes.batch_size
          # r = self.attributes.batch_size
          final_batch = l
          # flag = True
    
    
    
    
          while (
              l+1 < r
              and num_of_try_epochs != initial_num_epochs
              and self.attributes.batch_size < size_of_train_data
              # and num_of_try_epochs==0
              # and not find_flag
          ):
              #     if (
              #     num_of_try_epochs == initial_num_epochs
              #     or self.attributes.batch_size > size_of_train_data
              # ):
              #     # no rest of epochs are left to test the batch_size or
              #     # bacth_size is already bigger than train dataset
              #         flag = False
    
              try:
    
    
                  print(f'l:{l}')
                  print(f'r:{r}')
    
                  # mid = (l + r) // 2
                  mid = l + (r-l ) // 2
                  self.attributes.batch_size = mid  # increase the batch size
                  self.attributes.num_epochs = 1  # only run one epoch
                  # self.attributes.num_epochs = rest_epoachs
                  # if num_of_try_epochs!=0:
                  #   model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                  self.attributes.num_of_try_epochs = num_of_try_epochs
                  print(f'batch_size:{self.attributes.batch_size}')
                  mp.spawn(
                      fn=distributed_training,
                      args=(
                          world_size,
                          model,
                          kwargs["train_dataloaders"],
                          self.callbacks,
                          self.attributes,
                      ),
                      nprocs=world_size,
                      join=True,
                  )
                  # model.load_state_dict(
                  #     torch.load("model.pt", map_location=torch.device("cpu"))
                  # )
                  # os.remove("model.pt")
    
                  # num_of_try_epochs += 1
                  l = mid
                  # final_batch = (
                  #     mid  # find the current available batch_size, stop binary search
                  # )
                  # find_flag=True
                  final_batch = self.attributes.batch_size
                  num_of_try_epochs += 1
                  # model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                  # return final_batch,rest_epoachs,find_flag
              except Exception:
                if l + 1 == r and num_of_try_epochs==1:
                     r = l
                     self.attributes.batch_size = self.attributes.batch_size//2
                     l = self.attributes.batch_size
                     final_batch = l
                     continue
                r = mid
    
          # binary search cannot find batch size
          if num_of_try_epochs==1:
>           raise Exception('cannot find suitable batch size.')
E           Exception: cannot find suitable batch size.

dicee/trainer/torch_trainer_ddp.py:307: Exception
----------------------------- Captured stdout call -----------------------------
Start time:2023-07-05 20:22:13.035606
*** Read or Load Knowledge Graph  ***
*** Reading KGs/Nations/test.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0018 seconds | Current Memory Usage  1746.3 in MB
*** Reading KGs/Nations/train.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0019 seconds | Current Memory Usage  1746.3 in MB
Unrecognized data KGs/Nations/literals.txt
*** Reading KGs/Nations/valid.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0012 seconds | Current Memory Usage  1746.3 in MB
[3.1 / 14] Add reciprocal triples to train, validation, and test sets, e.g. KG:= {(s,p,o)} union {(o,p_inverse,s)}
Done !


Concatenating data to obtain index...
Done !

Creating a mapping from entities to integer indexes...
Done !

Done ! 0.003 seconds

Done !

Done !

Took 0.0106 seconds | Current Memory Usage  1746.3 in MB
Data Type conversion...
Submit er-vocab, re-vocab, and ee-vocab via  ProcessPoolExecutor...
Preprocessing took: 0.072 seconds

------------------- Description of Dataset KGs/Nations -------------------
Number of entities:14
Number of relations:110
Number of triples on train set:3184
Number of triples on valid set:398
Number of triples on test set:402
Entity Index:0.00000 in GB
Relation Index:0.00000 in GB
Train set :0.00001 in GB

# of CPUs:64 | # of GPUs:1 | # of CPUs for dataloader:1
NVIDIA GeForce RTX 3090
------------------- Train -------------------
Initializing TorchDDPTrainer GPU	Took 0.0002 seconds | Current Memory Usage  1746.3 in MB
Initializing Model...	Initializing the selected model... False
Took 0.0362 seconds | Current Memory Usage  1746.9 in MB
MyLCWALitModule(
  (model): NodePiece(
    (loss): BCEWithLogitsLoss()
    (interaction): DistMultInteraction()
    (entity_representations): ModuleList(
      (0): NodePieceRepresentation(
        (base): ModuleList(
          (0): TokenizationRepresentation(
            (vocabulary): Embedding(
              (_embeddings): Embedding(221, 64)
            )
          )
        )
        (combination): ConcatAggregationCombination()
      )
    )
    (relation_representations): ModuleList(
      (0): SubsetRepresentation(
        (base): Embedding(
          (_embeddings): Embedding(221, 64)
        )
      )
    )
    (weight_regularizers): ModuleList()
  )
  (loss): BCEWithLogitsLoss()
)
  | Name  | Type              | Params
--------------------------------------------
0 | model | NodePiece         | 14.1 K
1 | loss  | BCEWithLogitsLoss | 0     
--------------------------------------------
14.1 K    Trainable params
0         Non-trainable params
14.1 K    Total params
0.057     Total estimated model params size (MB)
Adam

Training is starting 2023-07-05 20:22:13.146512...
Max memory allocated after creating DDP:: 0.10888671875MB 
Free memory: 24259.69 MiB
GPU:0
DistributedDataParallel(
  (module): MyLCWALitModule(
    (model): NodePiece(
      (loss): BCEWithLogitsLoss()
      (interaction): DistMultInteraction()
      (entity_representations): ModuleList(
        (0): NodePieceRepresentation(
          (base): ModuleList(
            (0): TokenizationRepresentation(
              (vocabulary): Embedding(
                (_embeddings): Embedding(221, 64)
              )
            )
          )
          (combination): ConcatAggregationCombination()
        )
      )
      (relation_representations): ModuleList(
        (0): SubsetRepresentation(
          (base): Embedding(
            (_embeddings): Embedding(221, 64)
          )
        )
      )
      (weight_regularizers): ModuleList()
    )
    (loss): BCEWithLogitsLoss()
  )
)
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    weight_decay: 0
)
NumOfDataPoints:1818 | NumOfEpochs:1 | LearningRate:0.01 | BatchSize:20 | EpochBatchsize:91
l:10
r:20
batch_size:15
Max memory allocated after creating DDP:: 0.10888671875MB 
Free memory: 24259.69 MiB
GPU:0
DistributedDataParallel(
  (module): MyLCWALitModule(
    (model): NodePiece(
      (loss): BCEWithLogitsLoss()
      (interaction): DistMultInteraction()
      (entity_representations): ModuleList(
        (0): NodePieceRepresentation(
          (base): ModuleList(
            (0): TokenizationRepresentation(
              (vocabulary): Embedding(
                (_embeddings): Embedding(221, 64)
              )
            )
          )
          (combination): ConcatAggregationCombination()
        )
      )
      (relation_representations): ModuleList(
        (0): SubsetRepresentation(
          (base): Embedding(
            (_embeddings): Embedding(221, 64)
          )
        )
      )
      (weight_regularizers): ModuleList()
    )
    (loss): BCEWithLogitsLoss()
  )
)
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    weight_decay: 0
)
NumOfDataPoints:1818 | NumOfEpochs:1 | LearningRate:0.01 | BatchSize:15 | EpochBatchsize:122
l:10
r:15
batch_size:12
Max memory allocated after creating DDP:: 0.10888671875MB 
Free memory: 24259.69 MiB
GPU:0
DistributedDataParallel(
  (module): MyLCWALitModule(
    (model): NodePiece(
      (loss): BCEWithLogitsLoss()
      (interaction): DistMultInteraction()
      (entity_representations): ModuleList(
        (0): NodePieceRepresentation(
          (base): ModuleList(
            (0): TokenizationRepresentation(
              (vocabulary): Embedding(
                (_embeddings): Embedding(221, 64)
              )
            )
          )
          (combination): ConcatAggregationCombination()
        )
      )
      (relation_representations): ModuleList(
        (0): SubsetRepresentation(
          (base): Embedding(
            (_embeddings): Embedding(221, 64)
          )
        )
      )
      (weight_regularizers): ModuleList()
    )
    (loss): BCEWithLogitsLoss()
  )
)
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    weight_decay: 0
)
NumOfDataPoints:1818 | NumOfEpochs:1 | LearningRate:0.01 | BatchSize:12 | EpochBatchsize:152
l:10
r:12
batch_size:11
Max memory allocated after creating DDP:: 0.10888671875MB 
Free memory: 24259.69 MiB
GPU:0
DistributedDataParallel(
  (module): MyLCWALitModule(
    (model): NodePiece(
      (loss): BCEWithLogitsLoss()
      (interaction): DistMultInteraction()
      (entity_representations): ModuleList(
        (0): NodePieceRepresentation(
          (base): ModuleList(
            (0): TokenizationRepresentation(
              (vocabulary): Embedding(
                (_embeddings): Embedding(221, 64)
              )
            )
          )
          (combination): ConcatAggregationCombination()
        )
      )
      (relation_representations): ModuleList(
        (0): SubsetRepresentation(
          (base): Embedding(
            (_embeddings): Embedding(221, 64)
          )
        )
      )
      (weight_regularizers): ModuleList()
    )
    (loss): BCEWithLogitsLoss()
  )
)
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    weight_decay: 0
)
NumOfDataPoints:1818 | NumOfEpochs:1 | LearningRate:0.01 | BatchSize:11 | EpochBatchsize:166
----------------------------- Captured stderr call -----------------------------
sampling:   0%|          | 0.00/14.0 [00:00<?, ?it/s]                                                     ../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [32,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [33,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [34,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [35,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [36,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [37,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [38,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [39,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [40,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [41,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [42,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [43,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [44,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [45,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [46,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [47,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [48,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [49,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [50,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [51,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [52,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [53,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [54,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [55,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [56,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [57,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [58,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [59,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [60,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [61,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [62,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [63,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [64,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [65,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [66,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [67,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [68,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [69,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [70,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [71,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [72,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [73,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [74,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [75,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [76,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [77,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [78,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [79,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [80,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [81,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [82,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [83,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [84,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [85,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [86,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [87,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [88,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [89,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [90,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [91,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [92,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [93,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [94,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [95,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [96,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [97,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [98,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [99,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [100,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [101,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [102,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [103,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [104,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [105,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [106,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [107,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [108,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [109,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [110,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [111,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [112,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [113,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [114,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [115,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [116,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [117,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [118,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [119,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [120,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [121,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [122,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [123,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [124,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [125,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [126,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [127,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [0,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [1,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [2,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [3,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [4,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [5,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [6,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [7,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [8,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [9,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [10,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [11,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [12,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [13,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [14,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [15,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [16,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [17,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [18,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [19,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [20,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [21,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [22,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [23,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [24,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [25,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [26,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [27,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [28,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [29,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [30,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [8,0,0], thread: [31,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [64,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [65,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [66,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [67,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [68,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [69,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [70,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [71,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [72,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [73,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [74,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [75,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [76,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [77,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [78,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [79,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [80,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [81,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [82,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [83,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [84,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [85,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [86,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [87,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [88,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [89,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [90,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [91,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [92,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [93,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [94,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [95,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [0,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [1,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [2,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [3,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [4,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [5,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [6,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [7,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [8,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [9,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [10,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [11,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [12,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [13,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [14,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [15,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [16,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [17,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [18,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [19,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [20,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [21,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [22,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [23,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [24,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [25,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [26,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [27,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [28,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [29,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [30,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [7,0,0], thread: [31,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [32,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [33,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [34,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [35,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [36,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [37,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [38,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [39,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [40,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [41,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [42,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [43,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [44,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [45,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [46,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [47,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [48,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [49,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [50,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [51,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [52,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [53,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [54,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [55,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [56,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [57,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [58,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [59,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [60,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [61,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [62,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [63,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [96,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [97,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [98,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [99,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [100,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [101,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [102,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [103,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [104,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [105,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [106,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [107,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [108,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [109,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [110,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [111,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [112,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [113,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [114,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [115,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [116,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [117,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [118,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [119,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [120,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [121,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [122,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [123,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [124,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [125,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [126,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [127,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [0,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [1,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [2,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [3,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [4,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [5,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [6,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [7,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [8,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [9,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [10,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [11,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [12,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [13,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [14,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [15,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [16,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [17,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [18,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [19,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [20,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [21,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [22,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [23,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [24,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [25,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [26,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [27,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [28,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [29,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [30,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [31,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [64,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [65,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [66,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [67,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [68,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [69,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [70,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [71,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [72,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [73,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [74,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [75,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [76,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [77,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [78,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [79,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [80,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [81,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [82,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [83,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [84,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [85,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [86,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [87,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [88,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [89,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [90,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [91,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [92,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [93,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [94,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [6,0,0], thread: [95,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [0,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [1,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [2,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [3,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [4,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [5,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [6,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [7,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [8,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [9,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [10,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [11,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [12,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [13,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [14,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [15,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [16,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [17,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [18,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [19,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [20,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [21,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [22,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [23,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [24,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [25,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [26,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [27,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [28,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [29,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [30,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [31,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [64,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [65,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [66,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [67,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [68,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [69,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [70,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [71,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [72,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [73,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [74,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [75,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [76,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [77,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [78,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [79,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [80,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [81,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [82,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [83,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [84,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [85,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [86,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [87,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [88,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [89,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [90,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [91,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [92,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [93,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [94,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [95,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [32,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [33,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [34,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [35,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [36,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [37,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [38,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [39,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [40,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [41,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [42,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [43,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [44,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [45,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [46,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [47,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [48,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [49,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [50,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [51,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [52,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [53,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [54,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [55,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [56,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [57,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [58,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [59,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [60,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [61,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [62,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [63,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [96,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [97,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [98,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [99,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [100,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [101,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [102,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [103,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [104,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [105,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [106,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [107,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [108,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [109,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [110,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [111,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [112,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [113,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [114,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [115,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [116,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [117,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [118,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [119,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [120,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [121,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [122,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [123,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [124,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [125,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [126,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1146: indexSelectLargeIndex: block: [5,0,0], thread: [127,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [0,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [1,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [2,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [3,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [4,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [5,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [6,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [7,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [8,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [9,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [10,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [11,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [12,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [13,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [14,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [15,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [16,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [17,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [18,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [19,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [20,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [21,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [22,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [23,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [24,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [25,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [26,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [27,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [28,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [29,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [30,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [31,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [32,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [33,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [34,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [35,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [36,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [37,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [38,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [39,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [40,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [41,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [42,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [43,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [44,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [45,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [46,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [47,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [48,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [49,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [50,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [51,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [52,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [53,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [54,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [55,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [56,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [57,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [58,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [59,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [60,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [61,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [62,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [63,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [32,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [33,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [34,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [35,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [36,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [37,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [38,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [39,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [40,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [41,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [42,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [43,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [44,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [45,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [46,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [47,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [48,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [49,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [50,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [51,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [52,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [53,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [54,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [55,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [56,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [57,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [58,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [59,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [60,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [61,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [62,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [63,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [0,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [1,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [2,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [3,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [4,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [5,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [6,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [7,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [8,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [9,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [10,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [11,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [12,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [13,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [14,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [15,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [16,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [17,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [18,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [19,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [20,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [21,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [22,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [23,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [24,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [25,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [26,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [27,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [28,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [29,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [30,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [31,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [32,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [33,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [34,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [35,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [36,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [37,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [38,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [39,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [40,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [41,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [42,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [43,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [44,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [45,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [46,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [47,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [48,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [49,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [50,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [51,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [52,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [53,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [54,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [55,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [56,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [57,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [58,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [59,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [60,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [61,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [62,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [63,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [0,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [1,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [2,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [3,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [4,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [5,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [6,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [7,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [8,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [9,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [10,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [11,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [12,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [13,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [14,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [15,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [16,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [17,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [18,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [19,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [20,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [21,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [22,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [23,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [24,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [25,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [26,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [27,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [28,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [29,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [30,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [0,0,0], thread: [31,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
------------------------------ Captured log call -------------------------------
WARNING  pykeen.models.base:base.py:99 No random seed is specified. This may lead to non-reproducible results.
WARNING  pykeen.nn.combination:combination.py:58 No symbolic computation of output shape.
INFO     pykeen.triples.triples_factory:triples_factory.py:469 Creating inverse triples.
_______________ TestCallback.test_torchDDP_trainer[Pykeen_KG2E] ________________

self = <tests.test_trainers.TestCallback object at 0x7fb2f5c40070>
model_name = 'Pykeen_KG2E'

    @pytest.mark.filterwarnings("ignore::UserWarning")
    @pytest.mark.parametrize(
        "model_name",
        [
            "Pykeen_DistMult",
            "Pykeen_TuckER",
            "Pykeen_UM",
            "Pykeen_TransR",
            "Pykeen_TransH",
            "Pykeen_TransF",
            "Pykeen_TransE",
            "Pykeen_TransD",
            "Pykeen_TorusE",
            "Pykeen_SimplE",
            "Pykeen_SE",
            "Pykeen_RESCAL",
            "Pykeen_RotatE",
            "Pykeen_QuatE",
            "Pykeen_PairRE",
            "Pykeen_ProjE",
            "Pykeen_NTN",
            "Pykeen_NodePiece",
            "Pykeen_MuRE",
            "Pykeen_KG2E",
            "Pykeen_InductiveNodePiece",
            "Pykeen_InductiveNodePieceGNN",
            "Pykeen_HolE",
            "Pykeen_FixedModel",
            "Pykeen_ERMLPE",
            "Pykeen_DistMA",
            "Pykeen_CrossE",
            "Pykeen_CooccurrenceFilteredModel",
            "Pykeen_ConvKB",  # this one is really slow
            "Pykeen_ConvE",
            "Pykeen_ComplExLiteral",
            "Pykeen_ComplEx",
            "Pykeen_CompGCN",
            "Pykeen_CP",
            "Pykeen_BoxE",
            "Pykeen_AutoSF",
            "Pykeen_DistMultLiteral",
        ],
    )
    def test_torchDDP_trainer(self, model_name):
      import torch
      args = get_default_arguments([])
      # args.model = 'DistMult'
      # args.model = 'Pykeen_DistMult'
      # args.model = 'Pykeen_KG2E'
      # args.model = 'AConEx'
      args.model = model_name
      # args.scoring_technique = "NegSample"
      args.scoring_technique = 'KvsAll'
      args.path_dataset_folder = "KGs/Nations"
      args.num_epochs = 20
      args.batch_size = 20
      args.lr = 0.01
      args.embedding_dim = 64
      args.trainer = 'torchDDP'
      # args.trainer = "torchCPUTrainer"
      args.num_core = 1  # need to be bigger than 0
      args.eval_model = "test"
      args.normalization = None
      args.devices = "auto"
      args.accelerator = "auto"
      args.optim = "Adam"
      args.pykeen_model_kwargs = dict(
          embedding_dim=args.embedding_dim, loss="BCEWithLogitsLoss"
      )
      args.use_ddp_batch_finder = True
>     Execute(args).start()

tests/test_trainers.py:105: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dicee/executer.py:212: in start
    self.trained_model, form_of_labelling = self.trainer.start(dataset=self.dataset)
dicee/trainer/dice_trainer.py:251: in start
    self.trainer.fit(model,train_dataloaders=model.train_dataloaders)
dicee/trainer/torch_trainer_ddp.py:100: in fit
    final_batch, rest_epoachs = self.find_batch_size(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <dicee.trainer.torch_trainer_ddp.TorchDDPTrainer object at 0x7fb304ad31c0>
model = MyLCWALitModule(
  (model): KG2E(
    (loss): BCEWithLogitsLoss()
    (interaction): KG2EInteraction()
    (entity_rep...beddings): Embedding(110, 64)
      )
    )
    (weight_regularizers): ModuleList()
  )
  (loss): BCEWithLogitsLoss()
)
world_size = 1
kwargs = {'train_dataloaders': <torch.utils.data.dataloader.DataLoader object at 0x7fb2f5d6f250>}

    def find_batch_size(self, model, world_size, kwargs):
        # @TODO auto batch size implementation
        oom = False
        batch_size = self.attributes.batch_size  # batch size to increase
        initial_num_epochs = self.attributes.num_epochs
        num_of_try_epochs = 1
        rest_epoachs = 0
        double_counter = 0
        if "train_dataloaders" not in kwargs:
            # get the length of dataset from pykeen
            kwargs["train_dataloaders"] = model.train_dataloaders
            # size_of_train_data = len(model.dataset.training.triples)
    
        size_of_train_data = len(kwargs["train_dataloaders"].dataset)
    
        while not oom and double_counter < 5:
    
            try:
    
                rest_epoachs = initial_num_epochs - num_of_try_epochs
                if num_of_try_epochs == initial_num_epochs:
                    # no rest of epochs are left to test the batch_size or
                    # bacth_size is already bigger than train dataset
                    # oom = False
    
                    return self.attributes.batch_size, rest_epoachs
    
                if self.attributes.batch_size > size_of_train_data:
                    # go to binary search
                    oom = True
                    break
    
                self.attributes.num_epochs = 1  # only run one epoch
    
                # if num_of_try_epochs!=0:
                #   model.load_state_dict(torch.load("model.pt"))
                  # model.load_state_dict(torch.load("model.pt", map_location=torch.device("cpu")))
    
                if num_of_try_epochs != 1:
    
                  self.attributes.batch_size = self.attributes.batch_size*2 # make it faster
    
                self.attributes.num_of_try_epochs = num_of_try_epochs
    
                mp.spawn(
                    fn=distributed_training,
                    args=(
                        world_size,
                        model,
                        kwargs["train_dataloaders"],
                        self.callbacks,
                        self.attributes,
                    ),
                    nprocs=world_size,
                    join=True,
                )
                # model.load_state_dict(
                #     torch.load("model.pt", map_location=torch.device("cpu"))
                # )
                # os.remove("model.pt")
                # self.attributes.batch_size += batch_size  # increase the batch size
                # model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                num_of_try_epochs += 1
                double_counter +=1
    
    
            except Exception:
    
                oom = True
    
        # the batch_size here can be sure to fit in the memory of GPU
        # @TODO: there may be another method to find the batach size after oom
        # if num_of_try_epochs == 0:
        #     raise ValueError(
        #         f"batch_size of {self.attributes.batch_size} is too large or something wrong in the first try!"
        #     )
    
    
        # rest_epoachs = initial_num_epochs - num_of_try_epochs
        # find_flag =False
    
        # oom because of increaseing batch size or the origin batch size is too large
        if oom:
          r = self.attributes.batch_size
          # self.attributes.batch_size += (
          #     -batch_size
          # )  # reset the batch size to the last add
    
          self.attributes.batch_size = self.attributes.batch_size//2 # reset back to the old batch size
    
          l = self.attributes.batch_size
          # r = self.attributes.batch_size
          final_batch = l
          # flag = True
    
    
    
    
          while (
              l+1 < r
              and num_of_try_epochs != initial_num_epochs
              and self.attributes.batch_size < size_of_train_data
              # and num_of_try_epochs==0
              # and not find_flag
          ):
              #     if (
              #     num_of_try_epochs == initial_num_epochs
              #     or self.attributes.batch_size > size_of_train_data
              # ):
              #     # no rest of epochs are left to test the batch_size or
              #     # bacth_size is already bigger than train dataset
              #         flag = False
    
              try:
    
    
                  print(f'l:{l}')
                  print(f'r:{r}')
    
                  # mid = (l + r) // 2
                  mid = l + (r-l ) // 2
                  self.attributes.batch_size = mid  # increase the batch size
                  self.attributes.num_epochs = 1  # only run one epoch
                  # self.attributes.num_epochs = rest_epoachs
                  # if num_of_try_epochs!=0:
                  #   model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                  self.attributes.num_of_try_epochs = num_of_try_epochs
                  print(f'batch_size:{self.attributes.batch_size}')
                  mp.spawn(
                      fn=distributed_training,
                      args=(
                          world_size,
                          model,
                          kwargs["train_dataloaders"],
                          self.callbacks,
                          self.attributes,
                      ),
                      nprocs=world_size,
                      join=True,
                  )
                  # model.load_state_dict(
                  #     torch.load("model.pt", map_location=torch.device("cpu"))
                  # )
                  # os.remove("model.pt")
    
                  # num_of_try_epochs += 1
                  l = mid
                  # final_batch = (
                  #     mid  # find the current available batch_size, stop binary search
                  # )
                  # find_flag=True
                  final_batch = self.attributes.batch_size
                  num_of_try_epochs += 1
                  # model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                  # return final_batch,rest_epoachs,find_flag
              except Exception:
                if l + 1 == r and num_of_try_epochs==1:
                     r = l
                     self.attributes.batch_size = self.attributes.batch_size//2
                     l = self.attributes.batch_size
                     final_batch = l
                     continue
                r = mid
    
          # binary search cannot find batch size
          if num_of_try_epochs==1:
>           raise Exception('cannot find suitable batch size.')
E           Exception: cannot find suitable batch size.

dicee/trainer/torch_trainer_ddp.py:307: Exception
----------------------------- Captured stdout call -----------------------------
Start time:2023-07-05 20:23:07.919667
*** Read or Load Knowledge Graph  ***
*** Reading KGs/Nations/test.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0017 seconds | Current Memory Usage  1747.4 in MB
*** Reading KGs/Nations/train.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0017 seconds | Current Memory Usage  1747.4 in MB
Unrecognized data KGs/Nations/literals.txt
*** Reading KGs/Nations/valid.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0011 seconds | Current Memory Usage  1747.4 in MB
[3.1 / 14] Add reciprocal triples to train, validation, and test sets, e.g. KG:= {(s,p,o)} union {(o,p_inverse,s)}
Done !


Concatenating data to obtain index...
Done !

Creating a mapping from entities to integer indexes...
Done !

Done ! 0.003 seconds

Done !

Done !

Took 0.0103 seconds | Current Memory Usage  1747.4 in MB
Data Type conversion...
Submit er-vocab, re-vocab, and ee-vocab via  ProcessPoolExecutor...
Preprocessing took: 0.071 seconds

------------------- Description of Dataset KGs/Nations -------------------
Number of entities:14
Number of relations:110
Number of triples on train set:3184
Number of triples on valid set:398
Number of triples on test set:402
Entity Index:0.00000 in GB
Relation Index:0.00000 in GB
Train set :0.00001 in GB

# of CPUs:64 | # of GPUs:1 | # of CPUs for dataloader:1
NVIDIA GeForce RTX 3090
------------------- Train -------------------
Initializing TorchDDPTrainer GPU	Took 0.0007 seconds | Current Memory Usage  1747.4 in MB
Initializing Model...	Initializing the selected model... False
Took 0.0077 seconds | Current Memory Usage  1747.4 in MB
MyLCWALitModule(
  (model): KG2E(
    (loss): BCEWithLogitsLoss()
    (interaction): KG2EInteraction()
    (entity_representations): ModuleList(
      (0-1): 2 x Embedding(
        (_embeddings): Embedding(14, 64)
      )
    )
    (relation_representations): ModuleList(
      (0-1): 2 x Embedding(
        (_embeddings): Embedding(110, 64)
      )
    )
    (weight_regularizers): ModuleList()
  )
  (loss): BCEWithLogitsLoss()
)
  | Name  | Type              | Params
--------------------------------------------
0 | model | KG2E              | 15.9 K
1 | loss  | BCEWithLogitsLoss | 0     
--------------------------------------------
15.9 K    Trainable params
0         Non-trainable params
15.9 K    Total params
0.063     Total estimated model params size (MB)
Adam

Training is starting 2023-07-05 20:23:08.001870...
Max memory allocated after creating DDP:: 0.12109375MB 
Free memory: 24259.69 MiB
GPU:0
DistributedDataParallel(
  (module): MyLCWALitModule(
    (model): KG2E(
      (loss): BCEWithLogitsLoss()
      (interaction): KG2EInteraction()
      (entity_representations): ModuleList(
        (0-1): 2 x Embedding(
          (_embeddings): Embedding(14, 64)
        )
      )
      (relation_representations): ModuleList(
        (0-1): 2 x Embedding(
          (_embeddings): Embedding(110, 64)
        )
      )
      (weight_regularizers): ModuleList()
    )
    (loss): BCEWithLogitsLoss()
  )
)
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    weight_decay: 0
)
NumOfDataPoints:909 | NumOfEpochs:1 | LearningRate:0.01 | BatchSize:20 | EpochBatchsize:46
Epoch:1 | Batch:1 | Loss:56.18806457519531 |ForwardBackwardUpdate:0.01secs
Epoch:1 | Batch:2 | Loss:67.14134979248047 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:3 | Loss:47.941986083984375 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:4 | Loss:51.05023956298828 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:5 | Loss:38.73807144165039 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:6 | Loss:54.958518981933594 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
l:10
r:20
batch_size:15
Max memory allocated after creating DDP:: 0.12109375MB 
Free memory: 24259.69 MiB
GPU:0
DistributedDataParallel(
  (module): MyLCWALitModule(
    (model): KG2E(
      (loss): BCEWithLogitsLoss()
      (interaction): KG2EInteraction()
      (entity_representations): ModuleList(
        (0-1): 2 x Embedding(
          (_embeddings): Embedding(14, 64)
        )
      )
      (relation_representations): ModuleList(
        (0-1): 2 x Embedding(
          (_embeddings): Embedding(110, 64)
        )
      )
      (weight_regularizers): ModuleList()
    )
    (loss): BCEWithLogitsLoss()
  )
)
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    weight_decay: 0
)
NumOfDataPoints:909 | NumOfEpochs:1 | LearningRate:0.01 | BatchSize:15 | EpochBatchsize:61
Epoch:1 | Batch:1 | Loss:51.084861755371094 |ForwardBackwardUpdate:0.01secs
Epoch:1 | Batch:2 | Loss:77.65367889404297 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:3 | Loss:57.324440002441406 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:4 | Loss:42.115074157714844 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:5 | Loss:51.04827117919922 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:6 | Loss:38.600746154785156 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
l:10
r:15
batch_size:12
Max memory allocated after creating DDP:: 0.12109375MB 
Free memory: 24259.69 MiB
GPU:0
DistributedDataParallel(
  (module): MyLCWALitModule(
    (model): KG2E(
      (loss): BCEWithLogitsLoss()
      (interaction): KG2EInteraction()
      (entity_representations): ModuleList(
        (0-1): 2 x Embedding(
          (_embeddings): Embedding(14, 64)
        )
      )
      (relation_representations): ModuleList(
        (0-1): 2 x Embedding(
          (_embeddings): Embedding(110, 64)
        )
      )
      (weight_regularizers): ModuleList()
    )
    (loss): BCEWithLogitsLoss()
  )
)
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    weight_decay: 0
)
NumOfDataPoints:909 | NumOfEpochs:1 | LearningRate:0.01 | BatchSize:12 | EpochBatchsize:76
Epoch:1 | Batch:1 | Loss:49.3149299621582 |ForwardBackwardUpdate:0.01secs
Epoch:1 | Batch:2 | Loss:64.90563201904297 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:3 | Loss:76.61998748779297 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:4 | Loss:46.05622482299805 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:5 | Loss:41.65604019165039 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:6 | Loss:47.91175842285156 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
l:10
r:12
batch_size:11
Max memory allocated after creating DDP:: 0.12109375MB 
Free memory: 24259.69 MiB
GPU:0
DistributedDataParallel(
  (module): MyLCWALitModule(
    (model): KG2E(
      (loss): BCEWithLogitsLoss()
      (interaction): KG2EInteraction()
      (entity_representations): ModuleList(
        (0-1): 2 x Embedding(
          (_embeddings): Embedding(14, 64)
        )
      )
      (relation_representations): ModuleList(
        (0-1): 2 x Embedding(
          (_embeddings): Embedding(110, 64)
        )
      )
      (weight_regularizers): ModuleList()
    )
    (loss): BCEWithLogitsLoss()
  )
)
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    weight_decay: 0
)
NumOfDataPoints:909 | NumOfEpochs:1 | LearningRate:0.01 | BatchSize:11 | EpochBatchsize:83
Epoch:1 | Batch:1 | Loss:40.7252082824707 |ForwardBackwardUpdate:0.01secs
Epoch:1 | Batch:2 | Loss:76.25245666503906 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:3 | Loss:72.48713684082031 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:4 | Loss:48.926815032958984 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:5 | Loss:34.316925048828125 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
Epoch:1 | Batch:6 | Loss:62.13086700439453 |ForwardBackwardUpdate:0.00sec | BatchConst.:0.00sec
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/threading.py", line 973, in _bootstrap_inner
    self.run()
  File "/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/threading.py", line 910, in run
    self._target(*self._args, **self._kwargs)
  File "/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 51, in _pin_memory_loop
    do_one_step()
  File "/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in do_one_step
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/torch/multiprocessing/reductions.py", line 307, in rebuild_storage_fd
    fd = df.detach()
  File "/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/multiprocessing/connection.py", line 514, in Client
    deliver_challenge(c, authkey)
  File "/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/multiprocessing/connection.py", line 745, in deliver_challenge
    response = connection.recv_bytes(256)        # reject large message
  File "/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/multiprocessing/connection.py", line 221, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/multiprocessing/connection.py", line 419, in _recv_bytes
    buf = self._recv(4)
  File "/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/multiprocessing/connection.py", line 384, in _recv
    chunk = read(handle, remaining)
ConnectionResetError: [Errno 104] Connection reset by peer
------------------------------ Captured log call -------------------------------
WARNING  pykeen.models.base:base.py:99 No random seed is specified. This may lead to non-reproducible results.
________ TestCallback.test_torchDDP_trainer[Pykeen_InductiveNodePiece] _________

self = <tests.test_trainers.TestCallback object at 0x7fb2f5cf15e0>
model_name = 'Pykeen_InductiveNodePiece'

    @pytest.mark.filterwarnings("ignore::UserWarning")
    @pytest.mark.parametrize(
        "model_name",
        [
            "Pykeen_DistMult",
            "Pykeen_TuckER",
            "Pykeen_UM",
            "Pykeen_TransR",
            "Pykeen_TransH",
            "Pykeen_TransF",
            "Pykeen_TransE",
            "Pykeen_TransD",
            "Pykeen_TorusE",
            "Pykeen_SimplE",
            "Pykeen_SE",
            "Pykeen_RESCAL",
            "Pykeen_RotatE",
            "Pykeen_QuatE",
            "Pykeen_PairRE",
            "Pykeen_ProjE",
            "Pykeen_NTN",
            "Pykeen_NodePiece",
            "Pykeen_MuRE",
            "Pykeen_KG2E",
            "Pykeen_InductiveNodePiece",
            "Pykeen_InductiveNodePieceGNN",
            "Pykeen_HolE",
            "Pykeen_FixedModel",
            "Pykeen_ERMLPE",
            "Pykeen_DistMA",
            "Pykeen_CrossE",
            "Pykeen_CooccurrenceFilteredModel",
            "Pykeen_ConvKB",  # this one is really slow
            "Pykeen_ConvE",
            "Pykeen_ComplExLiteral",
            "Pykeen_ComplEx",
            "Pykeen_CompGCN",
            "Pykeen_CP",
            "Pykeen_BoxE",
            "Pykeen_AutoSF",
            "Pykeen_DistMultLiteral",
        ],
    )
    def test_torchDDP_trainer(self, model_name):
      import torch
      args = get_default_arguments([])
      # args.model = 'DistMult'
      # args.model = 'Pykeen_DistMult'
      # args.model = 'Pykeen_KG2E'
      # args.model = 'AConEx'
      args.model = model_name
      # args.scoring_technique = "NegSample"
      args.scoring_technique = 'KvsAll'
      args.path_dataset_folder = "KGs/Nations"
      args.num_epochs = 20
      args.batch_size = 20
      args.lr = 0.01
      args.embedding_dim = 64
      args.trainer = 'torchDDP'
      # args.trainer = "torchCPUTrainer"
      args.num_core = 1  # need to be bigger than 0
      args.eval_model = "test"
      args.normalization = None
      args.devices = "auto"
      args.accelerator = "auto"
      args.optim = "Adam"
      args.pykeen_model_kwargs = dict(
          embedding_dim=args.embedding_dim, loss="BCEWithLogitsLoss"
      )
      args.use_ddp_batch_finder = True
>     Execute(args).start()

tests/test_trainers.py:105: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dicee/executer.py:212: in start
    self.trained_model, form_of_labelling = self.trainer.start(dataset=self.dataset)
dicee/trainer/dice_trainer.py:238: in start
    model, form_of_labelling = self.initialize_or_load_model(dataset)
dicee/static_funcs.py:50: in timeit_wrapper
    result = func(*args, **kwargs)
dicee/trainer/dice_trainer.py:185: in initialize_or_load_model
    model, form_of_labelling = select_model(
dicee/static_funcs.py:97: in select_model
    intialize_model(args, dataset)
dicee/static_funcs.py:525: in intialize_model
    model = get_pykeen_model(model_name, args, dataset)
dicee/static_funcs.py:505: in get_pykeen_model
    model = MyLCWALitModule(
dicee/models/pykeen_LCWALitModule.py:11: in __init__
    super().__init__(**kwargs)
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/pykeen/contrib/lightning.py:112: in __init__
    self.model = model_resolver.make(model, model_kwargs, triples_factory=self.dataset.training)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <class_resolver.api.ClassResolver object at 0x7fb2ed573fa0>
query = 'InductiveNodePiece'
pos_kwargs = {'embedding_dim': 64, 'loss': 'BCEWithLogitsLoss'}
kwargs = {'triples_factory': TriplesFactory(num_entities=14, num_relations=110, create_inverse_triples=False, num_triples=3184)}
cls = <class 'pykeen.models.inductive.inductive_nodepiece.InductiveNodePiece'>

    def make(
        self,
        query: HintOrType[X],
        pos_kwargs: Optional[Mapping[str, Any]] = None,
        **kwargs,
    ) -> X:
        """Instantiate a class with optional kwargs."""
        if query is None or isinstance(query, (str, type)):
            cls: Type[X] = self.lookup(query)
            try:
                return cls(**(pos_kwargs or {}), **kwargs)  # type: ignore
            except TypeError as e:
                if "required keyword-only argument" in e.args[0]:
>                   raise KeywordArgumentError(cls, e.args[0]) from None
E                   class_resolver.api.KeywordArgumentError: InductiveNodePiece: __init__() missing 1 required keyword-only argument: 'inference_factory'

/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/class_resolver/api.py:207: KeywordArgumentError
----------------------------- Captured stdout call -----------------------------
Start time:2023-07-05 20:23:28.227020
*** Read or Load Knowledge Graph  ***
*** Reading KGs/Nations/test.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0035 seconds | Current Memory Usage  1747.6 in MB
*** Reading KGs/Nations/train.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0031 seconds | Current Memory Usage  1747.6 in MB
Unrecognized data KGs/Nations/literals.txt
*** Reading KGs/Nations/valid.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0020 seconds | Current Memory Usage  1747.6 in MB
[3.1 / 14] Add reciprocal triples to train, validation, and test sets, e.g. KG:= {(s,p,o)} union {(o,p_inverse,s)}
Done !


Concatenating data to obtain index...
Done !

Creating a mapping from entities to integer indexes...
Done !

Done ! 0.005 seconds

Done !

Done !

Took 0.0180 seconds | Current Memory Usage  1747.6 in MB
Data Type conversion...
Submit er-vocab, re-vocab, and ee-vocab via  ProcessPoolExecutor...
Preprocessing took: 0.085 seconds

------------------- Description of Dataset KGs/Nations -------------------
Number of entities:14
Number of relations:110
Number of triples on train set:3184
Number of triples on valid set:398
Number of triples on test set:402
Entity Index:0.00000 in GB
Relation Index:0.00000 in GB
Train set :0.00001 in GB

# of CPUs:64 | # of GPUs:1 | # of CPUs for dataloader:1
NVIDIA GeForce RTX 3090
------------------- Train -------------------
Initializing TorchDDPTrainer GPU	Took 0.0002 seconds | Current Memory Usage  1747.6 in MB
Initializing Model...	Initializing the selected model... False
_______ TestCallback.test_torchDDP_trainer[Pykeen_InductiveNodePieceGNN] _______

self = <tests.test_trainers.TestCallback object at 0x7fb2f5c17d90>
model_name = 'Pykeen_InductiveNodePieceGNN'

    @pytest.mark.filterwarnings("ignore::UserWarning")
    @pytest.mark.parametrize(
        "model_name",
        [
            "Pykeen_DistMult",
            "Pykeen_TuckER",
            "Pykeen_UM",
            "Pykeen_TransR",
            "Pykeen_TransH",
            "Pykeen_TransF",
            "Pykeen_TransE",
            "Pykeen_TransD",
            "Pykeen_TorusE",
            "Pykeen_SimplE",
            "Pykeen_SE",
            "Pykeen_RESCAL",
            "Pykeen_RotatE",
            "Pykeen_QuatE",
            "Pykeen_PairRE",
            "Pykeen_ProjE",
            "Pykeen_NTN",
            "Pykeen_NodePiece",
            "Pykeen_MuRE",
            "Pykeen_KG2E",
            "Pykeen_InductiveNodePiece",
            "Pykeen_InductiveNodePieceGNN",
            "Pykeen_HolE",
            "Pykeen_FixedModel",
            "Pykeen_ERMLPE",
            "Pykeen_DistMA",
            "Pykeen_CrossE",
            "Pykeen_CooccurrenceFilteredModel",
            "Pykeen_ConvKB",  # this one is really slow
            "Pykeen_ConvE",
            "Pykeen_ComplExLiteral",
            "Pykeen_ComplEx",
            "Pykeen_CompGCN",
            "Pykeen_CP",
            "Pykeen_BoxE",
            "Pykeen_AutoSF",
            "Pykeen_DistMultLiteral",
        ],
    )
    def test_torchDDP_trainer(self, model_name):
      import torch
      args = get_default_arguments([])
      # args.model = 'DistMult'
      # args.model = 'Pykeen_DistMult'
      # args.model = 'Pykeen_KG2E'
      # args.model = 'AConEx'
      args.model = model_name
      # args.scoring_technique = "NegSample"
      args.scoring_technique = 'KvsAll'
      args.path_dataset_folder = "KGs/Nations"
      args.num_epochs = 20
      args.batch_size = 20
      args.lr = 0.01
      args.embedding_dim = 64
      args.trainer = 'torchDDP'
      # args.trainer = "torchCPUTrainer"
      args.num_core = 1  # need to be bigger than 0
      args.eval_model = "test"
      args.normalization = None
      args.devices = "auto"
      args.accelerator = "auto"
      args.optim = "Adam"
      args.pykeen_model_kwargs = dict(
          embedding_dim=args.embedding_dim, loss="BCEWithLogitsLoss"
      )
      args.use_ddp_batch_finder = True
>     Execute(args).start()

tests/test_trainers.py:105: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dicee/executer.py:212: in start
    self.trained_model, form_of_labelling = self.trainer.start(dataset=self.dataset)
dicee/trainer/dice_trainer.py:238: in start
    model, form_of_labelling = self.initialize_or_load_model(dataset)
dicee/static_funcs.py:50: in timeit_wrapper
    result = func(*args, **kwargs)
dicee/trainer/dice_trainer.py:185: in initialize_or_load_model
    model, form_of_labelling = select_model(
dicee/static_funcs.py:97: in select_model
    intialize_model(args, dataset)
dicee/static_funcs.py:525: in intialize_model
    model = get_pykeen_model(model_name, args, dataset)
dicee/static_funcs.py:505: in get_pykeen_model
    model = MyLCWALitModule(
dicee/models/pykeen_LCWALitModule.py:11: in __init__
    super().__init__(**kwargs)
/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/pykeen/contrib/lightning.py:112: in __init__
    self.model = model_resolver.make(model, model_kwargs, triples_factory=self.dataset.training)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <class_resolver.api.ClassResolver object at 0x7fb2ed573fa0>
query = 'InductiveNodePieceGNN'
pos_kwargs = {'embedding_dim': 64, 'loss': 'BCEWithLogitsLoss'}
kwargs = {'triples_factory': TriplesFactory(num_entities=14, num_relations=110, create_inverse_triples=False, num_triples=3184)}
cls = <class 'pykeen.models.inductive.inductive_nodepiece_gnn.InductiveNodePieceGNN'>

    def make(
        self,
        query: HintOrType[X],
        pos_kwargs: Optional[Mapping[str, Any]] = None,
        **kwargs,
    ) -> X:
        """Instantiate a class with optional kwargs."""
        if query is None or isinstance(query, (str, type)):
            cls: Type[X] = self.lookup(query)
            try:
                return cls(**(pos_kwargs or {}), **kwargs)  # type: ignore
            except TypeError as e:
                if "required keyword-only argument" in e.args[0]:
>                   raise KeywordArgumentError(cls, e.args[0]) from None
E                   class_resolver.api.KeywordArgumentError: InductiveNodePieceGNN: __init__() missing 1 required keyword-only argument: 'inference_factory'

/upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/class_resolver/api.py:207: KeywordArgumentError
----------------------------- Captured stdout call -----------------------------
Start time:2023-07-05 20:23:28.369578
*** Read or Load Knowledge Graph  ***
*** Reading KGs/Nations/test.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0029 seconds | Current Memory Usage  1747.6 in MB
*** Reading KGs/Nations/train.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0019 seconds | Current Memory Usage  1747.6 in MB
Unrecognized data KGs/Nations/literals.txt
*** Reading KGs/Nations/valid.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0012 seconds | Current Memory Usage  1747.6 in MB
[3.1 / 14] Add reciprocal triples to train, validation, and test sets, e.g. KG:= {(s,p,o)} union {(o,p_inverse,s)}
Done !


Concatenating data to obtain index...
Done !

Creating a mapping from entities to integer indexes...
Done !

Done ! 0.003 seconds

Done !

Done !

Took 0.0106 seconds | Current Memory Usage  1747.6 in MB
Data Type conversion...
Submit er-vocab, re-vocab, and ee-vocab via  ProcessPoolExecutor...
Preprocessing took: 0.074 seconds

------------------- Description of Dataset KGs/Nations -------------------
Number of entities:14
Number of relations:110
Number of triples on train set:3184
Number of triples on valid set:398
Number of triples on test set:402
Entity Index:0.00000 in GB
Relation Index:0.00000 in GB
Train set :0.00001 in GB

# of CPUs:64 | # of GPUs:1 | # of CPUs for dataloader:1
NVIDIA GeForce RTX 3090
------------------- Train -------------------
Initializing TorchDDPTrainer GPU	Took 0.0002 seconds | Current Memory Usage  1747.6 in MB
Initializing Model...	Initializing the selected model... False
__________ TestCallback.test_torchDDP_trainer[Pykeen_ComplExLiteral] ___________

self = <tests.test_trainers.TestCallback object at 0x7fb30734fdc0>
model_name = 'Pykeen_ComplExLiteral'

    @pytest.mark.filterwarnings("ignore::UserWarning")
    @pytest.mark.parametrize(
        "model_name",
        [
            "Pykeen_DistMult",
            "Pykeen_TuckER",
            "Pykeen_UM",
            "Pykeen_TransR",
            "Pykeen_TransH",
            "Pykeen_TransF",
            "Pykeen_TransE",
            "Pykeen_TransD",
            "Pykeen_TorusE",
            "Pykeen_SimplE",
            "Pykeen_SE",
            "Pykeen_RESCAL",
            "Pykeen_RotatE",
            "Pykeen_QuatE",
            "Pykeen_PairRE",
            "Pykeen_ProjE",
            "Pykeen_NTN",
            "Pykeen_NodePiece",
            "Pykeen_MuRE",
            "Pykeen_KG2E",
            "Pykeen_InductiveNodePiece",
            "Pykeen_InductiveNodePieceGNN",
            "Pykeen_HolE",
            "Pykeen_FixedModel",
            "Pykeen_ERMLPE",
            "Pykeen_DistMA",
            "Pykeen_CrossE",
            "Pykeen_CooccurrenceFilteredModel",
            "Pykeen_ConvKB",  # this one is really slow
            "Pykeen_ConvE",
            "Pykeen_ComplExLiteral",
            "Pykeen_ComplEx",
            "Pykeen_CompGCN",
            "Pykeen_CP",
            "Pykeen_BoxE",
            "Pykeen_AutoSF",
            "Pykeen_DistMultLiteral",
        ],
    )
    def test_torchDDP_trainer(self, model_name):
      import torch
      args = get_default_arguments([])
      # args.model = 'DistMult'
      # args.model = 'Pykeen_DistMult'
      # args.model = 'Pykeen_KG2E'
      # args.model = 'AConEx'
      args.model = model_name
      # args.scoring_technique = "NegSample"
      args.scoring_technique = 'KvsAll'
      args.path_dataset_folder = "KGs/Nations"
      args.num_epochs = 20
      args.batch_size = 20
      args.lr = 0.01
      args.embedding_dim = 64
      args.trainer = 'torchDDP'
      # args.trainer = "torchCPUTrainer"
      args.num_core = 1  # need to be bigger than 0
      args.eval_model = "test"
      args.normalization = None
      args.devices = "auto"
      args.accelerator = "auto"
      args.optim = "Adam"
      args.pykeen_model_kwargs = dict(
          embedding_dim=args.embedding_dim, loss="BCEWithLogitsLoss"
      )
      args.use_ddp_batch_finder = True
>     Execute(args).start()

tests/test_trainers.py:105: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dicee/executer.py:212: in start
    self.trained_model, form_of_labelling = self.trainer.start(dataset=self.dataset)
dicee/trainer/dice_trainer.py:251: in start
    self.trainer.fit(model,train_dataloaders=model.train_dataloaders)
dicee/trainer/torch_trainer_ddp.py:100: in fit
    final_batch, rest_epoachs = self.find_batch_size(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <dicee.trainer.torch_trainer_ddp.TorchDDPTrainer object at 0x7fb2f5c40970>
model = MyLCWALitModule(
  (model): ComplExLiteral(
    (loss): BCEWithLogitsLoss()
    (interaction): ComplExInteraction()
  ...beddings): Embedding(55, 128)
      )
    )
    (weight_regularizers): ModuleList()
  )
  (loss): BCEWithLogitsLoss()
)
world_size = 1
kwargs = {'train_dataloaders': <torch.utils.data.dataloader.DataLoader object at 0x7fb25699dc40>}

    def find_batch_size(self, model, world_size, kwargs):
        # @TODO auto batch size implementation
        oom = False
        batch_size = self.attributes.batch_size  # batch size to increase
        initial_num_epochs = self.attributes.num_epochs
        num_of_try_epochs = 1
        rest_epoachs = 0
        double_counter = 0
        if "train_dataloaders" not in kwargs:
            # get the length of dataset from pykeen
            kwargs["train_dataloaders"] = model.train_dataloaders
            # size_of_train_data = len(model.dataset.training.triples)
    
        size_of_train_data = len(kwargs["train_dataloaders"].dataset)
    
        while not oom and double_counter < 5:
    
            try:
    
                rest_epoachs = initial_num_epochs - num_of_try_epochs
                if num_of_try_epochs == initial_num_epochs:
                    # no rest of epochs are left to test the batch_size or
                    # bacth_size is already bigger than train dataset
                    # oom = False
    
                    return self.attributes.batch_size, rest_epoachs
    
                if self.attributes.batch_size > size_of_train_data:
                    # go to binary search
                    oom = True
                    break
    
                self.attributes.num_epochs = 1  # only run one epoch
    
                # if num_of_try_epochs!=0:
                #   model.load_state_dict(torch.load("model.pt"))
                  # model.load_state_dict(torch.load("model.pt", map_location=torch.device("cpu")))
    
                if num_of_try_epochs != 1:
    
                  self.attributes.batch_size = self.attributes.batch_size*2 # make it faster
    
                self.attributes.num_of_try_epochs = num_of_try_epochs
    
                mp.spawn(
                    fn=distributed_training,
                    args=(
                        world_size,
                        model,
                        kwargs["train_dataloaders"],
                        self.callbacks,
                        self.attributes,
                    ),
                    nprocs=world_size,
                    join=True,
                )
                # model.load_state_dict(
                #     torch.load("model.pt", map_location=torch.device("cpu"))
                # )
                # os.remove("model.pt")
                # self.attributes.batch_size += batch_size  # increase the batch size
                # model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                num_of_try_epochs += 1
                double_counter +=1
    
    
            except Exception:
    
                oom = True
    
        # the batch_size here can be sure to fit in the memory of GPU
        # @TODO: there may be another method to find the batach size after oom
        # if num_of_try_epochs == 0:
        #     raise ValueError(
        #         f"batch_size of {self.attributes.batch_size} is too large or something wrong in the first try!"
        #     )
    
    
        # rest_epoachs = initial_num_epochs - num_of_try_epochs
        # find_flag =False
    
        # oom because of increaseing batch size or the origin batch size is too large
        if oom:
          r = self.attributes.batch_size
          # self.attributes.batch_size += (
          #     -batch_size
          # )  # reset the batch size to the last add
    
          self.attributes.batch_size = self.attributes.batch_size//2 # reset back to the old batch size
    
          l = self.attributes.batch_size
          # r = self.attributes.batch_size
          final_batch = l
          # flag = True
    
    
    
    
          while (
              l+1 < r
              and num_of_try_epochs != initial_num_epochs
              and self.attributes.batch_size < size_of_train_data
              # and num_of_try_epochs==0
              # and not find_flag
          ):
              #     if (
              #     num_of_try_epochs == initial_num_epochs
              #     or self.attributes.batch_size > size_of_train_data
              # ):
              #     # no rest of epochs are left to test the batch_size or
              #     # bacth_size is already bigger than train dataset
              #         flag = False
    
              try:
    
    
                  print(f'l:{l}')
                  print(f'r:{r}')
    
                  # mid = (l + r) // 2
                  mid = l + (r-l ) // 2
                  self.attributes.batch_size = mid  # increase the batch size
                  self.attributes.num_epochs = 1  # only run one epoch
                  # self.attributes.num_epochs = rest_epoachs
                  # if num_of_try_epochs!=0:
                  #   model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                  self.attributes.num_of_try_epochs = num_of_try_epochs
                  print(f'batch_size:{self.attributes.batch_size}')
                  mp.spawn(
                      fn=distributed_training,
                      args=(
                          world_size,
                          model,
                          kwargs["train_dataloaders"],
                          self.callbacks,
                          self.attributes,
                      ),
                      nprocs=world_size,
                      join=True,
                  )
                  # model.load_state_dict(
                  #     torch.load("model.pt", map_location=torch.device("cpu"))
                  # )
                  # os.remove("model.pt")
    
                  # num_of_try_epochs += 1
                  l = mid
                  # final_batch = (
                  #     mid  # find the current available batch_size, stop binary search
                  # )
                  # find_flag=True
                  final_batch = self.attributes.batch_size
                  num_of_try_epochs += 1
                  # model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                  # return final_batch,rest_epoachs,find_flag
              except Exception:
                if l + 1 == r and num_of_try_epochs==1:
                     r = l
                     self.attributes.batch_size = self.attributes.batch_size//2
                     l = self.attributes.batch_size
                     final_batch = l
                     continue
                r = mid
    
          # binary search cannot find batch size
          if num_of_try_epochs==1:
>           raise Exception('cannot find suitable batch size.')
E           Exception: cannot find suitable batch size.

dicee/trainer/torch_trainer_ddp.py:307: Exception
----------------------------- Captured stdout call -----------------------------
Start time:2023-07-05 20:28:31.717883
*** Read or Load Knowledge Graph  ***
*** Reading KGs/Nations/test.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0037 seconds | Current Memory Usage  1768.6 in MB
*** Reading KGs/Nations/train.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0042 seconds | Current Memory Usage  1768.6 in MB
Unrecognized data KGs/Nations/literals.txt
*** Reading KGs/Nations/valid.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0030 seconds | Current Memory Usage  1768.6 in MB
[3.1 / 14] Add reciprocal triples to train, validation, and test sets, e.g. KG:= {(s,p,o)} union {(o,p_inverse,s)}
Done !


Concatenating data to obtain index...
Done !

Creating a mapping from entities to integer indexes...
Done !

Done ! 0.003 seconds

Done !

Done !

Took 0.0153 seconds | Current Memory Usage  1768.6 in MB
Data Type conversion...
Submit er-vocab, re-vocab, and ee-vocab via  ProcessPoolExecutor...
Preprocessing took: 0.083 seconds

------------------- Description of Dataset KGs/Nations -------------------
Number of entities:14
Number of relations:110
Number of triples on train set:3184
Number of triples on valid set:398
Number of triples on test set:402
Entity Index:0.00000 in GB
Relation Index:0.00000 in GB
Train set :0.00001 in GB

# of CPUs:64 | # of GPUs:1 | # of CPUs for dataloader:1
NVIDIA GeForce RTX 3090
------------------- Train -------------------
Initializing TorchDDPTrainer GPU	Took 0.0003 seconds | Current Memory Usage  1768.6 in MB
Initializing Model...	Initializing the selected model... False
Took 0.0227 seconds | Current Memory Usage  1768.9 in MB
MyLCWALitModule(
  (model): ComplExLiteral(
    (loss): BCEWithLogitsLoss()
    (interaction): ComplExInteraction()
    (entity_representations): ModuleList(
      (0): CombinedRepresentation(
        (base): ModuleList(
          (0): Embedding(
            (_embeddings): Embedding(14, 128)
          )
          (1): Embedding(
            (_embeddings): Embedding(14, 2)
          )
        )
        (combination): ComplexSeparatedCombination(
          (real_combination): ConcatProjectionCombination(
            (projection): Sequential(
              (0): Linear(in_features=66, out_features=64, bias=True)
              (1): Dropout(p=0.2, inplace=False)
              (2): Tanh()
            )
          )
          (imag_combination): ConcatProjectionCombination(
            (projection): Sequential(
              (0): Linear(in_features=66, out_features=64, bias=True)
              (1): Dropout(p=0.2, inplace=False)
              (2): Tanh()
            )
          )
        )
      )
    )
    (relation_representations): ModuleList(
      (0): Embedding(
        (_embeddings): Embedding(55, 128)
      )
    )
    (weight_regularizers): ModuleList()
  )
  (loss): BCEWithLogitsLoss()
)
  | Name  | Type              | Params
--------------------------------------------
0 | model | ComplExLiteral    | 17.4 K
1 | loss  | BCEWithLogitsLoss | 0     
--------------------------------------------
17.4 K    Trainable params
28        Non-trainable params
17.4 K    Total params
0.070     Total estimated model params size (MB)
Adam

Training is starting 2023-07-05 20:28:31.828443...
l:10
r:20
batch_size:15
l:10
r:15
batch_size:12
l:10
r:12
batch_size:11
------------------------------ Captured log call -------------------------------
WARNING  pykeen.models.base:base.py:99 No random seed is specified. This may lead to non-reproducible results.
WARNING  pykeen.nn.combination:combination.py:58 No symbolic computation of output shape.
______________ TestCallback.test_torchDDP_trainer[Pykeen_CompGCN] ______________

self = <tests.test_trainers.TestCallback object at 0x7fb304acff10>
model_name = 'Pykeen_CompGCN'

    @pytest.mark.filterwarnings("ignore::UserWarning")
    @pytest.mark.parametrize(
        "model_name",
        [
            "Pykeen_DistMult",
            "Pykeen_TuckER",
            "Pykeen_UM",
            "Pykeen_TransR",
            "Pykeen_TransH",
            "Pykeen_TransF",
            "Pykeen_TransE",
            "Pykeen_TransD",
            "Pykeen_TorusE",
            "Pykeen_SimplE",
            "Pykeen_SE",
            "Pykeen_RESCAL",
            "Pykeen_RotatE",
            "Pykeen_QuatE",
            "Pykeen_PairRE",
            "Pykeen_ProjE",
            "Pykeen_NTN",
            "Pykeen_NodePiece",
            "Pykeen_MuRE",
            "Pykeen_KG2E",
            "Pykeen_InductiveNodePiece",
            "Pykeen_InductiveNodePieceGNN",
            "Pykeen_HolE",
            "Pykeen_FixedModel",
            "Pykeen_ERMLPE",
            "Pykeen_DistMA",
            "Pykeen_CrossE",
            "Pykeen_CooccurrenceFilteredModel",
            "Pykeen_ConvKB",  # this one is really slow
            "Pykeen_ConvE",
            "Pykeen_ComplExLiteral",
            "Pykeen_ComplEx",
            "Pykeen_CompGCN",
            "Pykeen_CP",
            "Pykeen_BoxE",
            "Pykeen_AutoSF",
            "Pykeen_DistMultLiteral",
        ],
    )
    def test_torchDDP_trainer(self, model_name):
      import torch
      args = get_default_arguments([])
      # args.model = 'DistMult'
      # args.model = 'Pykeen_DistMult'
      # args.model = 'Pykeen_KG2E'
      # args.model = 'AConEx'
      args.model = model_name
      # args.scoring_technique = "NegSample"
      args.scoring_technique = 'KvsAll'
      args.path_dataset_folder = "KGs/Nations"
      args.num_epochs = 20
      args.batch_size = 20
      args.lr = 0.01
      args.embedding_dim = 64
      args.trainer = 'torchDDP'
      # args.trainer = "torchCPUTrainer"
      args.num_core = 1  # need to be bigger than 0
      args.eval_model = "test"
      args.normalization = None
      args.devices = "auto"
      args.accelerator = "auto"
      args.optim = "Adam"
      args.pykeen_model_kwargs = dict(
          embedding_dim=args.embedding_dim, loss="BCEWithLogitsLoss"
      )
      args.use_ddp_batch_finder = True
>     Execute(args).start()

tests/test_trainers.py:105: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dicee/executer.py:212: in start
    self.trained_model, form_of_labelling = self.trainer.start(dataset=self.dataset)
dicee/trainer/dice_trainer.py:251: in start
    self.trainer.fit(model,train_dataloaders=model.train_dataloaders)
dicee/trainer/torch_trainer_ddp.py:100: in fit
    final_batch, rest_epoachs = self.find_batch_size(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <dicee.trainer.torch_trainer_ddp.TorchDDPTrainer object at 0x7fb2f5ada820>
model = MyLCWALitModule(
  (model): CompGCN(
    (loss): BCEWithLogitsLoss()
    (interaction): DistMultInteraction()
    (ent...      )
          )
        )
      )
    )
    (weight_regularizers): ModuleList()
  )
  (loss): BCEWithLogitsLoss()
)
world_size = 1
kwargs = {'train_dataloaders': <torch.utils.data.dataloader.DataLoader object at 0x7fb37277d490>}

    def find_batch_size(self, model, world_size, kwargs):
        # @TODO auto batch size implementation
        oom = False
        batch_size = self.attributes.batch_size  # batch size to increase
        initial_num_epochs = self.attributes.num_epochs
        num_of_try_epochs = 1
        rest_epoachs = 0
        double_counter = 0
        if "train_dataloaders" not in kwargs:
            # get the length of dataset from pykeen
            kwargs["train_dataloaders"] = model.train_dataloaders
            # size_of_train_data = len(model.dataset.training.triples)
    
        size_of_train_data = len(kwargs["train_dataloaders"].dataset)
    
        while not oom and double_counter < 5:
    
            try:
    
                rest_epoachs = initial_num_epochs - num_of_try_epochs
                if num_of_try_epochs == initial_num_epochs:
                    # no rest of epochs are left to test the batch_size or
                    # bacth_size is already bigger than train dataset
                    # oom = False
    
                    return self.attributes.batch_size, rest_epoachs
    
                if self.attributes.batch_size > size_of_train_data:
                    # go to binary search
                    oom = True
                    break
    
                self.attributes.num_epochs = 1  # only run one epoch
    
                # if num_of_try_epochs!=0:
                #   model.load_state_dict(torch.load("model.pt"))
                  # model.load_state_dict(torch.load("model.pt", map_location=torch.device("cpu")))
    
                if num_of_try_epochs != 1:
    
                  self.attributes.batch_size = self.attributes.batch_size*2 # make it faster
    
                self.attributes.num_of_try_epochs = num_of_try_epochs
    
                mp.spawn(
                    fn=distributed_training,
                    args=(
                        world_size,
                        model,
                        kwargs["train_dataloaders"],
                        self.callbacks,
                        self.attributes,
                    ),
                    nprocs=world_size,
                    join=True,
                )
                # model.load_state_dict(
                #     torch.load("model.pt", map_location=torch.device("cpu"))
                # )
                # os.remove("model.pt")
                # self.attributes.batch_size += batch_size  # increase the batch size
                # model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                num_of_try_epochs += 1
                double_counter +=1
    
    
            except Exception:
    
                oom = True
    
        # the batch_size here can be sure to fit in the memory of GPU
        # @TODO: there may be another method to find the batach size after oom
        # if num_of_try_epochs == 0:
        #     raise ValueError(
        #         f"batch_size of {self.attributes.batch_size} is too large or something wrong in the first try!"
        #     )
    
    
        # rest_epoachs = initial_num_epochs - num_of_try_epochs
        # find_flag =False
    
        # oom because of increaseing batch size or the origin batch size is too large
        if oom:
          r = self.attributes.batch_size
          # self.attributes.batch_size += (
          #     -batch_size
          # )  # reset the batch size to the last add
    
          self.attributes.batch_size = self.attributes.batch_size//2 # reset back to the old batch size
    
          l = self.attributes.batch_size
          # r = self.attributes.batch_size
          final_batch = l
          # flag = True
    
    
    
    
          while (
              l+1 < r
              and num_of_try_epochs != initial_num_epochs
              and self.attributes.batch_size < size_of_train_data
              # and num_of_try_epochs==0
              # and not find_flag
          ):
              #     if (
              #     num_of_try_epochs == initial_num_epochs
              #     or self.attributes.batch_size > size_of_train_data
              # ):
              #     # no rest of epochs are left to test the batch_size or
              #     # bacth_size is already bigger than train dataset
              #         flag = False
    
              try:
    
    
                  print(f'l:{l}')
                  print(f'r:{r}')
    
                  # mid = (l + r) // 2
                  mid = l + (r-l ) // 2
                  self.attributes.batch_size = mid  # increase the batch size
                  self.attributes.num_epochs = 1  # only run one epoch
                  # self.attributes.num_epochs = rest_epoachs
                  # if num_of_try_epochs!=0:
                  #   model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                  self.attributes.num_of_try_epochs = num_of_try_epochs
                  print(f'batch_size:{self.attributes.batch_size}')
                  mp.spawn(
                      fn=distributed_training,
                      args=(
                          world_size,
                          model,
                          kwargs["train_dataloaders"],
                          self.callbacks,
                          self.attributes,
                      ),
                      nprocs=world_size,
                      join=True,
                  )
                  # model.load_state_dict(
                  #     torch.load("model.pt", map_location=torch.device("cpu"))
                  # )
                  # os.remove("model.pt")
    
                  # num_of_try_epochs += 1
                  l = mid
                  # final_batch = (
                  #     mid  # find the current available batch_size, stop binary search
                  # )
                  # find_flag=True
                  final_batch = self.attributes.batch_size
                  num_of_try_epochs += 1
                  # model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                  # return final_batch,rest_epoachs,find_flag
              except Exception:
                if l + 1 == r and num_of_try_epochs==1:
                     r = l
                     self.attributes.batch_size = self.attributes.batch_size//2
                     l = self.attributes.batch_size
                     final_batch = l
                     continue
                r = mid
    
          # binary search cannot find batch size
          if num_of_try_epochs==1:
>           raise Exception('cannot find suitable batch size.')
E           Exception: cannot find suitable batch size.

dicee/trainer/torch_trainer_ddp.py:307: Exception
----------------------------- Captured stdout call -----------------------------
Start time:2023-07-05 20:29:09.036791
*** Read or Load Knowledge Graph  ***
*** Reading KGs/Nations/test.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0017 seconds | Current Memory Usage  1769.3 in MB
*** Reading KGs/Nations/train.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0017 seconds | Current Memory Usage  1769.3 in MB
Unrecognized data KGs/Nations/literals.txt
*** Reading KGs/Nations/valid.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0011 seconds | Current Memory Usage  1769.3 in MB
[3.1 / 14] Add reciprocal triples to train, validation, and test sets, e.g. KG:= {(s,p,o)} union {(o,p_inverse,s)}
Done !


Concatenating data to obtain index...
Done !

Creating a mapping from entities to integer indexes...
Done !

Done ! 0.003 seconds

Done !

Done !

Took 0.0102 seconds | Current Memory Usage  1769.3 in MB
Data Type conversion...
Submit er-vocab, re-vocab, and ee-vocab via  ProcessPoolExecutor...
Preprocessing took: 0.072 seconds

------------------- Description of Dataset KGs/Nations -------------------
Number of entities:14
Number of relations:110
Number of triples on train set:3184
Number of triples on valid set:398
Number of triples on test set:402
Entity Index:0.00000 in GB
Relation Index:0.00000 in GB
Train set :0.00001 in GB

# of CPUs:64 | # of GPUs:1 | # of CPUs for dataloader:1
NVIDIA GeForce RTX 3090
------------------- Train -------------------
Initializing TorchDDPTrainer GPU	Took 0.0002 seconds | Current Memory Usage  1769.3 in MB
Initializing Model...	Initializing the selected model... False
Took 0.0115 seconds | Current Memory Usage  1769.3 in MB
MyLCWALitModule(
  (model): CompGCN(
    (loss): BCEWithLogitsLoss()
    (interaction): DistMultInteraction()
    (entity_representations): ModuleList(
      (0): SingleCompGCNRepresentation(
        (combined): CombinedCompGCNRepresentations(
          (entity_representations): Embedding(
            (_embeddings): Embedding(14, 64)
          )
          (relation_representations): Embedding(
            (_embeddings): Embedding(220, 64)
          )
          (layers): ModuleList(
            (0): CompGCNLayer(
              (composition): MultiplicationCompositionModule()
              (edge_weighting): SymmetricEdgeWeighting()
              (w_rel): Linear(in_features=64, out_features=64, bias=False)
              (drop): Dropout(p=0.0, inplace=False)
              (bn): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (bias): Bias()
              (activation): Identity()
            )
          )
        )
      )
    )
    (relation_representations): ModuleList(
      (0): SingleCompGCNRepresentation(
        (combined): CombinedCompGCNRepresentations(
          (entity_representations): Embedding(
            (_embeddings): Embedding(14, 64)
          )
          (relation_representations): Embedding(
            (_embeddings): Embedding(220, 64)
          )
          (layers): ModuleList(
            (0): CompGCNLayer(
              (composition): MultiplicationCompositionModule()
              (edge_weighting): SymmetricEdgeWeighting()
              (w_rel): Linear(in_features=64, out_features=64, bias=False)
              (drop): Dropout(p=0.0, inplace=False)
              (bn): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (bias): Bias()
              (activation): Identity()
            )
          )
        )
      )
    )
    (weight_regularizers): ModuleList()
  )
  (loss): BCEWithLogitsLoss()
)
  | Name  | Type              | Params
--------------------------------------------
0 | model | CompGCN           | 31.6 K
1 | loss  | BCEWithLogitsLoss | 0     
--------------------------------------------
31.6 K    Trainable params
0         Non-trainable params
31.6 K    Total params
0.126     Total estimated model params size (MB)
Adam

Training is starting 2023-07-05 20:29:09.122255...
l:10
r:20
batch_size:15
l:10
r:15
batch_size:12
l:10
r:12
batch_size:11
------------------------------ Captured log call -------------------------------
WARNING  pykeen.models.base:base.py:99 No random seed is specified. This may lead to non-reproducible results.
INFO     pykeen.triples.triples_factory:triples_factory.py:469 Creating inverse triples.
__________ TestCallback.test_torchDDP_trainer[Pykeen_DistMultLiteral] __________

self = <tests.test_trainers.TestCallback object at 0x7fb305163910>
model_name = 'Pykeen_DistMultLiteral'

    @pytest.mark.filterwarnings("ignore::UserWarning")
    @pytest.mark.parametrize(
        "model_name",
        [
            "Pykeen_DistMult",
            "Pykeen_TuckER",
            "Pykeen_UM",
            "Pykeen_TransR",
            "Pykeen_TransH",
            "Pykeen_TransF",
            "Pykeen_TransE",
            "Pykeen_TransD",
            "Pykeen_TorusE",
            "Pykeen_SimplE",
            "Pykeen_SE",
            "Pykeen_RESCAL",
            "Pykeen_RotatE",
            "Pykeen_QuatE",
            "Pykeen_PairRE",
            "Pykeen_ProjE",
            "Pykeen_NTN",
            "Pykeen_NodePiece",
            "Pykeen_MuRE",
            "Pykeen_KG2E",
            "Pykeen_InductiveNodePiece",
            "Pykeen_InductiveNodePieceGNN",
            "Pykeen_HolE",
            "Pykeen_FixedModel",
            "Pykeen_ERMLPE",
            "Pykeen_DistMA",
            "Pykeen_CrossE",
            "Pykeen_CooccurrenceFilteredModel",
            "Pykeen_ConvKB",  # this one is really slow
            "Pykeen_ConvE",
            "Pykeen_ComplExLiteral",
            "Pykeen_ComplEx",
            "Pykeen_CompGCN",
            "Pykeen_CP",
            "Pykeen_BoxE",
            "Pykeen_AutoSF",
            "Pykeen_DistMultLiteral",
        ],
    )
    def test_torchDDP_trainer(self, model_name):
      import torch
      args = get_default_arguments([])
      # args.model = 'DistMult'
      # args.model = 'Pykeen_DistMult'
      # args.model = 'Pykeen_KG2E'
      # args.model = 'AConEx'
      args.model = model_name
      # args.scoring_technique = "NegSample"
      args.scoring_technique = 'KvsAll'
      args.path_dataset_folder = "KGs/Nations"
      args.num_epochs = 20
      args.batch_size = 20
      args.lr = 0.01
      args.embedding_dim = 64
      args.trainer = 'torchDDP'
      # args.trainer = "torchCPUTrainer"
      args.num_core = 1  # need to be bigger than 0
      args.eval_model = "test"
      args.normalization = None
      args.devices = "auto"
      args.accelerator = "auto"
      args.optim = "Adam"
      args.pykeen_model_kwargs = dict(
          embedding_dim=args.embedding_dim, loss="BCEWithLogitsLoss"
      )
      args.use_ddp_batch_finder = True
>     Execute(args).start()

tests/test_trainers.py:105: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dicee/executer.py:212: in start
    self.trained_model, form_of_labelling = self.trainer.start(dataset=self.dataset)
dicee/trainer/dice_trainer.py:251: in start
    self.trainer.fit(model,train_dataloaders=model.train_dataloaders)
dicee/trainer/torch_trainer_ddp.py:100: in fit
    final_batch, rest_epoachs = self.find_batch_size(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <dicee.trainer.torch_trainer_ddp.TorchDDPTrainer object at 0x7fb37277e940>
model = MyLCWALitModule(
  (model): DistMultLiteral(
    (loss): BCEWithLogitsLoss()
    (interaction): DistMultInteraction()
...mbeddings): Embedding(55, 64)
      )
    )
    (weight_regularizers): ModuleList()
  )
  (loss): BCEWithLogitsLoss()
)
world_size = 1
kwargs = {'train_dataloaders': <torch.utils.data.dataloader.DataLoader object at 0x7fb3726f9370>}

    def find_batch_size(self, model, world_size, kwargs):
        # @TODO auto batch size implementation
        oom = False
        batch_size = self.attributes.batch_size  # batch size to increase
        initial_num_epochs = self.attributes.num_epochs
        num_of_try_epochs = 1
        rest_epoachs = 0
        double_counter = 0
        if "train_dataloaders" not in kwargs:
            # get the length of dataset from pykeen
            kwargs["train_dataloaders"] = model.train_dataloaders
            # size_of_train_data = len(model.dataset.training.triples)
    
        size_of_train_data = len(kwargs["train_dataloaders"].dataset)
    
        while not oom and double_counter < 5:
    
            try:
    
                rest_epoachs = initial_num_epochs - num_of_try_epochs
                if num_of_try_epochs == initial_num_epochs:
                    # no rest of epochs are left to test the batch_size or
                    # bacth_size is already bigger than train dataset
                    # oom = False
    
                    return self.attributes.batch_size, rest_epoachs
    
                if self.attributes.batch_size > size_of_train_data:
                    # go to binary search
                    oom = True
                    break
    
                self.attributes.num_epochs = 1  # only run one epoch
    
                # if num_of_try_epochs!=0:
                #   model.load_state_dict(torch.load("model.pt"))
                  # model.load_state_dict(torch.load("model.pt", map_location=torch.device("cpu")))
    
                if num_of_try_epochs != 1:
    
                  self.attributes.batch_size = self.attributes.batch_size*2 # make it faster
    
                self.attributes.num_of_try_epochs = num_of_try_epochs
    
                mp.spawn(
                    fn=distributed_training,
                    args=(
                        world_size,
                        model,
                        kwargs["train_dataloaders"],
                        self.callbacks,
                        self.attributes,
                    ),
                    nprocs=world_size,
                    join=True,
                )
                # model.load_state_dict(
                #     torch.load("model.pt", map_location=torch.device("cpu"))
                # )
                # os.remove("model.pt")
                # self.attributes.batch_size += batch_size  # increase the batch size
                # model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                num_of_try_epochs += 1
                double_counter +=1
    
    
            except Exception:
    
                oom = True
    
        # the batch_size here can be sure to fit in the memory of GPU
        # @TODO: there may be another method to find the batach size after oom
        # if num_of_try_epochs == 0:
        #     raise ValueError(
        #         f"batch_size of {self.attributes.batch_size} is too large or something wrong in the first try!"
        #     )
    
    
        # rest_epoachs = initial_num_epochs - num_of_try_epochs
        # find_flag =False
    
        # oom because of increaseing batch size or the origin batch size is too large
        if oom:
          r = self.attributes.batch_size
          # self.attributes.batch_size += (
          #     -batch_size
          # )  # reset the batch size to the last add
    
          self.attributes.batch_size = self.attributes.batch_size//2 # reset back to the old batch size
    
          l = self.attributes.batch_size
          # r = self.attributes.batch_size
          final_batch = l
          # flag = True
    
    
    
    
          while (
              l+1 < r
              and num_of_try_epochs != initial_num_epochs
              and self.attributes.batch_size < size_of_train_data
              # and num_of_try_epochs==0
              # and not find_flag
          ):
              #     if (
              #     num_of_try_epochs == initial_num_epochs
              #     or self.attributes.batch_size > size_of_train_data
              # ):
              #     # no rest of epochs are left to test the batch_size or
              #     # bacth_size is already bigger than train dataset
              #         flag = False
    
              try:
    
    
                  print(f'l:{l}')
                  print(f'r:{r}')
    
                  # mid = (l + r) // 2
                  mid = l + (r-l ) // 2
                  self.attributes.batch_size = mid  # increase the batch size
                  self.attributes.num_epochs = 1  # only run one epoch
                  # self.attributes.num_epochs = rest_epoachs
                  # if num_of_try_epochs!=0:
                  #   model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                  self.attributes.num_of_try_epochs = num_of_try_epochs
                  print(f'batch_size:{self.attributes.batch_size}')
                  mp.spawn(
                      fn=distributed_training,
                      args=(
                          world_size,
                          model,
                          kwargs["train_dataloaders"],
                          self.callbacks,
                          self.attributes,
                      ),
                      nprocs=world_size,
                      join=True,
                  )
                  # model.load_state_dict(
                  #     torch.load("model.pt", map_location=torch.device("cpu"))
                  # )
                  # os.remove("model.pt")
    
                  # num_of_try_epochs += 1
                  l = mid
                  # final_batch = (
                  #     mid  # find the current available batch_size, stop binary search
                  # )
                  # find_flag=True
                  final_batch = self.attributes.batch_size
                  num_of_try_epochs += 1
                  # model.load_state_dict(torch.load("model.pt",map_location='cpu'))
                  # return final_batch,rest_epoachs,find_flag
              except Exception:
                if l + 1 == r and num_of_try_epochs==1:
                     r = l
                     self.attributes.batch_size = self.attributes.batch_size//2
                     l = self.attributes.batch_size
                     final_batch = l
                     continue
                r = mid
    
          # binary search cannot find batch size
          if num_of_try_epochs==1:
>           raise Exception('cannot find suitable batch size.')
E           Exception: cannot find suitable batch size.

dicee/trainer/torch_trainer_ddp.py:307: Exception
----------------------------- Captured stdout call -----------------------------
Start time:2023-07-05 20:30:54.788705
*** Read or Load Knowledge Graph  ***
*** Reading KGs/Nations/test.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0025 seconds | Current Memory Usage  1770.2 in MB
*** Reading KGs/Nations/train.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0030 seconds | Current Memory Usage  1770.2 in MB
Unrecognized data KGs/Nations/literals.txt
*** Reading KGs/Nations/valid.txt with Pandas ***
Reading with pandas.read_csv with sep ** s+ ** ...
Took 0.0016 seconds | Current Memory Usage  1770.2 in MB
[3.1 / 14] Add reciprocal triples to train, validation, and test sets, e.g. KG:= {(s,p,o)} union {(o,p_inverse,s)}
Done !


Concatenating data to obtain index...
Done !

Creating a mapping from entities to integer indexes...
Done !

Done ! 0.003 seconds

Done !

Done !

Took 0.0101 seconds | Current Memory Usage  1770.2 in MB
Data Type conversion...
Submit er-vocab, re-vocab, and ee-vocab via  ProcessPoolExecutor...
Preprocessing took: 0.069 seconds

------------------- Description of Dataset KGs/Nations -------------------
Number of entities:14
Number of relations:110
Number of triples on train set:3184
Number of triples on valid set:398
Number of triples on test set:402
Entity Index:0.00000 in GB
Relation Index:0.00000 in GB
Train set :0.00001 in GB

# of CPUs:64 | # of GPUs:1 | # of CPUs for dataloader:1
NVIDIA GeForce RTX 3090
------------------- Train -------------------
Initializing TorchDDPTrainer GPU	Took 0.0002 seconds | Current Memory Usage  1770.2 in MB
Initializing Model...	Initializing the selected model... False
Took 0.0154 seconds | Current Memory Usage  1770.2 in MB
MyLCWALitModule(
  (model): DistMultLiteral(
    (loss): BCEWithLogitsLoss()
    (interaction): DistMultInteraction()
    (entity_representations): ModuleList(
      (0): CombinedRepresentation(
        (base): ModuleList(
          (0): Embedding(
            (_embeddings): Embedding(14, 64)
          )
          (1): Embedding(
            (_embeddings): Embedding(14, 2)
          )
        )
        (combination): ConcatProjectionCombination(
          (projection): Sequential(
            (0): Linear(in_features=66, out_features=64, bias=True)
            (1): Dropout(p=0.0, inplace=False)
            (2): Identity()
          )
        )
      )
    )
    (relation_representations): ModuleList(
      (0): Embedding(
        (_embeddings): Embedding(55, 64)
      )
    )
    (weight_regularizers): ModuleList()
  )
  (loss): BCEWithLogitsLoss()
)
  | Name  | Type              | Params
--------------------------------------------
0 | model | DistMultLiteral   | 8.7 K 
1 | loss  | BCEWithLogitsLoss | 0     
--------------------------------------------
8.7 K     Trainable params
28        Non-trainable params
8.7 K     Total params
0.035     Total estimated model params size (MB)
Adam

Training is starting 2023-07-05 20:30:54.875628...
l:10
r:20
batch_size:15
l:10
r:15
batch_size:12
l:10
r:12
batch_size:11
------------------------------ Captured log call -------------------------------
WARNING  pykeen.models.base:base.py:99 No random seed is specified. This may lead to non-reproducible results.
WARNING  pykeen.nn.combination:combination.py:58 No symbolic computation of output shape.
=============================== warnings summary ===============================
../../../../../../../../../../upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/torch/utils/tensorboard/__init__.py:4
  /upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/torch/utils/tensorboard/__init__.py:4: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if not hasattr(tensorboard, "__version__") or LooseVersion(

../../../../../../../../../../upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/torch/utils/tensorboard/__init__.py:6
  /upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/torch/utils/tensorboard/__init__.py:6: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    ) < LooseVersion("1.15"):

../../../../../../../../../../upb/users/r/renzhong/profiles/unix/cs/.local/lib/python3.9/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:326
  /upb/users/r/renzhong/profiles/unix/cs/.local/lib/python3.9/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:326: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)
    np.bool8: (False, True),

tests/test_trainers.py::TestCallback::test_conex_torch_cpu_trainer
  /upb/users/r/renzhong/profiles/unix/cs/.conda/envs/pykeen/lib/python3.9/site-packages/torch/distributed/_sharded_tensor/__init__.py:8: DeprecationWarning: torch.distributed._sharded_tensor will be deprecated, use torch.distributed._shard.sharded_tensor instead
    warnings.warn(

tests/test_trainers.py: 36 warnings
  /local/upb/users/r/renzhong/profiles/unix/cs/Dicee/dice-embeddings/dicee/abstracts.py:53: LightningDeprecationWarning: The `LightningModule.summarize` method is deprecated in v1.5 and will be removed in v1.7. Use `pytorch_lightning.utilities.model_summary.summarize` instead.
    c.on_fit_start(*args, **kwargs)

-- Docs: https://docs.pytest.org/en/stable/warnings.html
=========================== short test summary info ============================
FAILED tests/test_trainers.py::TestCallback::test_aconex_pl_trainer - Runtime...
FAILED tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_NodePiece]
FAILED tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_KG2E]
FAILED tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_InductiveNodePiece]
FAILED tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_InductiveNodePieceGNN]
FAILED tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_ComplExLiteral]
FAILED tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_CompGCN]
FAILED tests/test_trainers.py::TestCallback::test_torchDDP_trainer[Pykeen_DistMultLiteral]
============ 8 failed, 31 passed, 40 warnings in 1135.59s (0:18:55) ============
