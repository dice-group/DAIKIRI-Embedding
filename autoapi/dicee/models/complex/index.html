<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dicee.models.complex &mdash; DICE Embeddings 0.1.3.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8775fe07" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/theme.css?v=ea877efc" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/theme_tweak.css?v=f0ad19f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8775fe07" />

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=c6726a90"></script>
        <script src="../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="dicee.models.dualE" href="../dualE/index.html" />
    <link rel="prev" title="dicee.models.clifford" href="../clifford/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            DICE Embeddings
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/main.html">Dicee Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/main.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/main.html#download-knowledge-graphs">Download Knowledge Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/main.html#knowledge-graph-embedding-models">Knowledge Graph Embedding Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/main.html#how-to-train">How to Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/main.html#creating-an-embedding-vector-database">Creating an Embedding Vector Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/main.html#answering-complex-queries">Answering Complex Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/main.html#predicting-missing-links">Predicting Missing Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/main.html#downloading-pretrained-models">Downloading Pretrained Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/main.html#how-to-deploy">How to Deploy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/main.html#docker">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/main.html#how-to-cite">How to cite</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee</span></code></a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models</span></code></a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../index.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="../base_model/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models.base_model</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../clifford/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models.clifford</span></code></a></li>
<li class="toctree-l5 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models.complex</span></code></a><ul>
<li class="toctree-l6"><a class="reference internal" href="#module-contents">Module Contents</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../dualE/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models.dualE</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../function_space/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models.function_space</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../octonion/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models.octonion</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../pykeen_models/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models.pykeen_models</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../quaternion/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models.quaternion</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../real/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models.real</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../static_funcs/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models.static_funcs</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../transformers/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models.transformers</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../index.html#package-contents">Package Contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../read_preprocess_save_load_kg/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.read_preprocess_save_load_kg</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scripts/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.scripts</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../trainer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.trainer</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#package-contents">Package Contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">DICE Embeddings</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee</span></code></a></li>
          <li class="breadcrumb-item"><a href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models</span></code></a></li>
      <li class="breadcrumb-item active"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models.complex</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/autoapi/dicee/models/complex/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-dicee.models.complex">
<span id="dicee-models-complex"></span><h1><a class="reference internal" href="#module-dicee.models.complex" title="dicee.models.complex"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dicee.models.complex</span></code></a><a class="headerlink" href="#module-dicee.models.complex" title="Link to this heading"></a></h1>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading"></a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dicee.models.complex.ConEx" title="dicee.models.complex.ConEx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConEx</span></code></a></p></td>
<td><p>ConEx (Convolutional ComplEx) is a Knowledge Graph Embedding model that extends ComplEx embeddings with convolutional layers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dicee.models.complex.AConEx" title="dicee.models.complex.AConEx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AConEx</span></code></a></p></td>
<td><p>AConEx (Additive Convolutional ComplEx) extends the ConEx model by incorporating</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dicee.models.complex.ComplEx" title="dicee.models.complex.ComplEx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ComplEx</span></code></a></p></td>
<td><p>ComplEx (Complex Embeddings for Knowledge Graphs) is a model that extends</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="dicee.models.complex.ConEx">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dicee.models.complex.</span></span><span class="sig-name descname"><span class="pre">ConEx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#ConEx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dicee.models.complex.ConEx" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../base_model/index.html#dicee.models.base_model.BaseKGE" title="dicee.models.base_model.BaseKGE"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dicee.models.base_model.BaseKGE</span></code></a></p>
<p>ConEx (Convolutional ComplEx) is a Knowledge Graph Embedding model that extends ComplEx embeddings with convolutional layers.
It integrates convolutional neural networks into the embedding process to capture complex patterns in the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>dict</em>) – A dictionary of arguments containing hyperparameters and settings for the model, such as embedding dimensions,
kernel size, number of output channels, and dropout rates.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dicee.models.complex.ConEx.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#dicee.models.complex.ConEx.name" title="Link to this definition"></a></dt>
<dd><p>The name identifier for the ConEx model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dicee.models.complex.ConEx.conv2d">
<span class="sig-name descname"><span class="pre">conv2d</span></span><a class="headerlink" href="#dicee.models.complex.ConEx.conv2d" title="Link to this definition"></a></dt>
<dd><p>A 2D convolutional layer used for processing complex-valued embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Conv2d</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dicee.models.complex.ConEx.fc1">
<span class="sig-name descname"><span class="pre">fc1</span></span><a class="headerlink" href="#dicee.models.complex.ConEx.fc1" title="Link to this definition"></a></dt>
<dd><p>A fully connected linear layer for compressing the output of the convolutional layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Linear</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dicee.models.complex.ConEx.norm_fc1">
<span class="sig-name descname"><span class="pre">norm_fc1</span></span><a class="headerlink" href="#dicee.models.complex.ConEx.norm_fc1" title="Link to this definition"></a></dt>
<dd><p>Normalization layer applied after the fully connected layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Normalizer</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dicee.models.complex.ConEx.bn_conv2d">
<span class="sig-name descname"><span class="pre">bn_conv2d</span></span><a class="headerlink" href="#dicee.models.complex.ConEx.bn_conv2d" title="Link to this definition"></a></dt>
<dd><p>Batch normalization layer applied after the convolutional operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.BatchNorm2d</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dicee.models.complex.ConEx.feature_map_dropout">
<span class="sig-name descname"><span class="pre">feature_map_dropout</span></span><a class="headerlink" href="#dicee.models.complex.ConEx.feature_map_dropout" title="Link to this definition"></a></dt>
<dd><p>Dropout layer applied to the output of the convolutional layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Dropout2d</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dicee.models.complex.ConEx.residual_convolution">
<span class="sig-name descname"><span class="pre">residual_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#ConEx.residual_convolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dicee.models.complex.ConEx.residual_convolution" title="Link to this definition"></a></dt>
<dd><p>Performs a residual convolution operation on two complex-valued embeddings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dicee.models.complex.ConEx.forward_k_vs_all">
<span class="sig-name descname"><span class="pre">forward_k_vs_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.FloatTensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#ConEx.forward_k_vs_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dicee.models.complex.ConEx.forward_k_vs_all" title="Link to this definition"></a></dt>
<dd><p>Computes scores in a K-vs-All setting using convolutional operations on embeddings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dicee.models.complex.ConEx.forward_triples">
<span class="sig-name descname"><span class="pre">forward_triples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.FloatTensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#ConEx.forward_triples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dicee.models.complex.ConEx.forward_triples" title="Link to this definition"></a></dt>
<dd><p>Computes scores for a batch of triples using convolutional operations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dicee.models.complex.ConEx.forward_k_vs_sample">
<span class="sig-name descname"><span class="pre">forward_k_vs_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_entity_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#ConEx.forward_k_vs_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dicee.models.complex.ConEx.forward_k_vs_sample" title="Link to this definition"></a></dt>
<dd><p>Computes scores against a sampled subset of entities using convolutional operations.</p>
</dd></dl>

<p class="rubric">Notes</p>
<p>ConEx combines complex-valued embeddings with convolutional neural networks to capture intricate patterns and interactions
in the knowledge graph, potentially leading to improved performance on tasks like link prediction.</p>
<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">residual_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.FloatTensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.FloatTensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#ConEx.residual_convolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Computes the residual score of two complex-valued embeddings by applying convolutional operations.
This method is a key component of the ConEx model, combining complex embeddings with convolutional neural networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C_1</strong> (<em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch.Tensor</em><em>]</em>) – A tuple consisting of two PyTorch tensors representing the real and imaginary components of the first complex-valued embedding.</p></li>
<li><p><strong>C_2</strong> (<em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch.Tensor</em><em>]</em>) – A tuple consisting of two PyTorch tensors representing the real and imaginary components of the second complex-valued embedding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of two tensors, representing the real and imaginary parts of the convolutionally transformed embeddings.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.FloatTensor, torch.FloatTensor]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method involves concatenating the real and imaginary components of the embeddings, applying a 2D convolution,
followed by batch normalization, ReLU activation, dropout, and a fully connected layer. This process is intended to
capture complex interactions between the embeddings in a convolutional manner.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">forward_k_vs_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.FloatTensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#ConEx.forward_k_vs_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Computes scores in a K-vs-All setting using convolutional operations on complex-valued embeddings.
This method is used for evaluating the performance of the model by computing scores for each head entity
and relation pair against all possible tail entities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – A tensor representing a batch of head entities and relations. Expected tensor shape: (n, 2),
where ‘n’ is the batch size and ‘2’ represents head entity and relation pairs.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor containing the scores for each head entity and relation pair against all possible tail entities.
Tensor shape: (n, <a href="#id8"><span class="problematic" id="id9">|E|</span></a>), where ‘<a href="#id10"><span class="problematic" id="id11">|E|</span></a>’ is the number of entities in the knowledge graph.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.FloatTensor</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method retrieves embeddings for head entities and relations, splits them into real and imaginary parts,
and applies a convolution operation. It then computes the Hermitian product of the transformed embeddings
with all tail entity embeddings to generate scores. This approach allows for capturing complex relational patterns
in the knowledge graph.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">forward_triples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.FloatTensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#ConEx.forward_triples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Computes scores for a batch of triples using convolutional operations on complex-valued embeddings.
This method is crucial for evaluating the performance of the model on individual triples in the
knowledge graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – A tensor representing a batch of triples. Each triple consists of indices for a head entity,
a relation, and a tail entity. Expected tensor shape: (n, 3), where ‘n’ is the number of triples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor containing the scores for each triple in the batch. Tensor shape: (n,), where ‘n’
is the number of triples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.FloatTensor</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method retrieves embeddings for head entities, relations, and tail entities, and splits them
into real and imaginary parts. It then applies a convolution operation on these embeddings and
computes the Hermitian inner product, which involves a combination of real and imaginary parts
of the embeddings. This process is designed to capture complex relational patterns and interactions
within the knowledge graph, leveraging the power of convolutional neural networks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">forward_k_vs_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_entity_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#ConEx.forward_k_vs_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>Computes scores against a sampled subset of entities using convolutional operations
on complex-valued embeddings. This method is particularly useful for large knowledge graphs
where computing scores against all entities is computationally expensive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – A tensor representing a batch of head entities and relations. Expected tensor shape:
(batch_size, 2), where ‘batch_size’ is the number of head entity and relation pairs.</p></li>
<li><p><strong>target_entity_idx</strong> (<em>torch.Tensor</em>) – A tensor of target entity indices for sampling. Tensor shape:
(batch_size, num_selected_entities).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor containing the scores for each head entity and relation pair against the sampled
subset of tail entities. Tensor shape: (batch_size, num_selected_entities).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method first retrieves and processes the embeddings for head entities and relations. It then
applies a convolution operation and computes the Hermitian inner product with the embeddings of
the sampled tail entities. This process enables capturing complex relational patterns in a
computationally efficient manner.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dicee.models.complex.AConEx">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dicee.models.complex.</span></span><span class="sig-name descname"><span class="pre">AConEx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#AConEx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dicee.models.complex.AConEx" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../base_model/index.html#dicee.models.base_model.BaseKGE" title="dicee.models.base_model.BaseKGE"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dicee.models.base_model.BaseKGE</span></code></a></p>
<p>AConEx (Additive Convolutional ComplEx) extends the ConEx model by incorporating
additive connections in the convolutional operations. This model integrates
convolutional neural networks with complex-valued embeddings, emphasizing
additive feature interactions for knowledge graph embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>dict</em>) – A dictionary of arguments containing hyperparameters and settings for the model,
such as embedding dimensions, kernel size, number of output channels, and dropout rates.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dicee.models.complex.AConEx.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#dicee.models.complex.AConEx.name" title="Link to this definition"></a></dt>
<dd><p>The name identifier for the AConEx model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dicee.models.complex.AConEx.conv2d">
<span class="sig-name descname"><span class="pre">conv2d</span></span><a class="headerlink" href="#dicee.models.complex.AConEx.conv2d" title="Link to this definition"></a></dt>
<dd><p>A 2D convolutional layer used for processing complex-valued embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Conv2d</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dicee.models.complex.AConEx.fc_num_input">
<span class="sig-name descname"><span class="pre">fc_num_input</span></span><a class="headerlink" href="#dicee.models.complex.AConEx.fc_num_input" title="Link to this definition"></a></dt>
<dd><p>The number of input features for the fully connected layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dicee.models.complex.AConEx.fc1">
<span class="sig-name descname"><span class="pre">fc1</span></span><a class="headerlink" href="#dicee.models.complex.AConEx.fc1" title="Link to this definition"></a></dt>
<dd><p>A fully connected linear layer for compressing the output of the
convolutional layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Linear</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dicee.models.complex.AConEx.norm_fc1">
<span class="sig-name descname"><span class="pre">norm_fc1</span></span><a class="headerlink" href="#dicee.models.complex.AConEx.norm_fc1" title="Link to this definition"></a></dt>
<dd><p>Normalization layer applied after the fully connected layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Normalizer</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dicee.models.complex.AConEx.bn_conv2d">
<span class="sig-name descname"><span class="pre">bn_conv2d</span></span><a class="headerlink" href="#dicee.models.complex.AConEx.bn_conv2d" title="Link to this definition"></a></dt>
<dd><p>Batch normalization layer applied after the convolutional operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.BatchNorm2d</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dicee.models.complex.AConEx.feature_map_dropout">
<span class="sig-name descname"><span class="pre">feature_map_dropout</span></span><a class="headerlink" href="#dicee.models.complex.AConEx.feature_map_dropout" title="Link to this definition"></a></dt>
<dd><p>Dropout layer applied to the output of the convolutional layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Dropout2d</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">residual_convolution(C_1:</span> <span class="pre">Tuple[torch.Tensor,</span> <span class="pre">torch.Tensor],</span></span></dt>
<dd><blockquote>
<div><p>C_2: Tuple[torch.Tensor, torch.Tensor]) -&gt; Tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor]</p>
</div></blockquote>
<p>Performs a residual convolution operation on two complex-valued embeddings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dicee.models.complex.AConEx.forward_k_vs_all">
<span class="sig-name descname"><span class="pre">forward_k_vs_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.FloatTensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#AConEx.forward_k_vs_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dicee.models.complex.AConEx.forward_k_vs_all" title="Link to this definition"></a></dt>
<dd><p>Computes scores in a K-vs-All setting using convolutional operations on embeddings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dicee.models.complex.AConEx.forward_triples">
<span class="sig-name descname"><span class="pre">forward_triples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.FloatTensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#AConEx.forward_triples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dicee.models.complex.AConEx.forward_triples" title="Link to this definition"></a></dt>
<dd><p>Computes scores for a batch of triples using convolutional operations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dicee.models.complex.AConEx.forward_k_vs_sample">
<span class="sig-name descname"><span class="pre">forward_k_vs_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_entity_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#AConEx.forward_k_vs_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dicee.models.complex.AConEx.forward_k_vs_sample" title="Link to this definition"></a></dt>
<dd><p>Computes scores against a sampled subset of entities using convolutional operations.</p>
</dd></dl>

<p class="rubric">Notes</p>
<p>AConEx aims to enhance the modeling capabilities of knowledge graph embeddings
by adding more complex interaction patterns through convolutional layers, potentially
improving performance on tasks like link prediction.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dicee.models.complex.AConEx.residual_convolution">
<span class="sig-name descname"><span class="pre">residual_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.FloatTensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.FloatTensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.FloatTensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.FloatTensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#AConEx.residual_convolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dicee.models.complex.AConEx.residual_convolution" title="Link to this definition"></a></dt>
<dd><p>Computes the residual convolution of two complex-valued embeddings. This method
is a core part of the AConEx model, applying convolutional neural network techniques
to complex-valued embeddings to capture intricate relationships in the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C_1</strong> (<em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch.Tensor</em><em>]</em>) – A tuple of two PyTorch tensors representing the real and imaginary components
of the first complex-valued embedding.</p></li>
<li><p><strong>C_2</strong> (<em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch.Tensor</em><em>]</em>) – A tuple of two PyTorch tensors representing the real and imaginary components
of the second complex-valued embedding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of four tensors, each representing a component of the convolutionally
transformed embeddings. These components correspond to the modified real
and imaginary parts of the input embeddings.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.FloatTensor, torch.FloatTensor, torch.FloatTensor, torch.FloatTensor]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method concatenates the real and imaginary components of the embeddings and
applies a 2D convolution, followed by batch normalization, ReLU activation, dropout,
and a fully connected layer. This convolutional process is designed to enhance
the model’s ability to capture complex patterns in knowledge graph embeddings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">forward_k_vs_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.FloatTensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#AConEx.forward_k_vs_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Computes scores in a K-vs-All setting using convolutional and additive operations on
complex-valued embeddings. This method evaluates the performance of the model by computing
scores for each head entity and relation pair against all possible tail entities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – A tensor representing a batch of head entities and relations. Expected tensor shape:
(batch_size, 2), where ‘batch_size’ is the number of head entity and relation pairs.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor containing the scores for each head entity and relation pair against all possible
tail entities. Tensor shape: (batch_size, <a href="#id12"><span class="problematic" id="id13">|E|</span></a>), where ‘<a href="#id14"><span class="problematic" id="id15">|E|</span></a>’ is the number of entities
in the knowledge graph.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.FloatTensor</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method first retrieves embeddings for head entities and relations, splits them into real
and imaginary parts, and applies a convolutional operation. It then computes the Hermitian
inner product with all tail entity embeddings, using an additive approach that combines the
convolutional results with the original embeddings. This technique aims to capture complex
relational patterns in the knowledge graph.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">forward_triples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.FloatTensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#AConEx.forward_triples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Computes scores for a batch of triples using convolutional operations and additive connections
on complex-valued embeddings. This method is key for evaluating the model’s performance on
individual triples within the knowledge graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – A tensor representing a batch of triples. Each triple consists of indices for a head entity,
a relation, and a tail entity. Expected tensor shape: (n, 3), where ‘n’ is the number of triples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor containing the scores for each triple in the batch. Tensor shape: (n,), where ‘n’
is the number of triples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.FloatTensor</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method retrieves embeddings for head entities, relations, and tail entities, and splits them
into real and imaginary parts. It then applies a convolution operation on these embeddings and
computes the Hermitian inner product, enhanced with an additive connection. This approach allows
the model to capture complex relational patterns within the knowledge graph, potentially improving
prediction accuracy and interpretability.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">forward_k_vs_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_entity_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.FloatTensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#AConEx.forward_k_vs_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd><p>Computes scores for a batch of samples (entity pairs) given a batch of queries. This method is used
to predict the scores for different tail entities for a set of query triples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – A tensor representing a batch of query triples. Each triple consists of indices for a head entity,
a relation, and a dummy tail entity (used for scoring). Expected tensor shape: (n, 3), where ‘n’ is
the number of query triples.</p></li>
<li><p><strong>target_entity_idx</strong> (<em>torch.Tensor</em>) – A tensor containing the indices of the target tail entities for which scores are to be predicted.
Expected tensor shape: (n, m), where ‘n’ is the number of queries and ‘m’ is the number of target
entities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor containing the scores for each query-triple and target-entity pair. Tensor shape: (n, m),
where ‘n’ is the number of queries and ‘m’ is the number of target entities.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.FloatTensor</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method retrieves embeddings for the head entities and relations in the query triples, splits them
into real and imaginary parts, and applies convolutional operations with additive connections to capture
complex patterns. It also retrieves embeddings for the target tail entities and computes Hermitian inner
products to obtain scores, allowing the model to rank the tail entities based on their relevance to the queries.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dicee.models.complex.ComplEx">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dicee.models.complex.</span></span><span class="sig-name descname"><span class="pre">ComplEx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#ComplEx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dicee.models.complex.ComplEx" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../base_model/index.html#dicee.models.base_model.BaseKGE" title="dicee.models.base_model.BaseKGE"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dicee.models.base_model.BaseKGE</span></code></a></p>
<p>ComplEx (Complex Embeddings for Knowledge Graphs) is a model that extends
the base knowledge graph embedding approach by using complex-valued embeddings.
It emphasizes the interaction of real and imaginary components of embeddings
to capture the asymmetric relationships often found in knowledge graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>dict</em>) – A dictionary of arguments containing hyperparameters and settings for the model,
such as embedding dimensions, learning rate, and regularization methods.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dicee.models.complex.ComplEx.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#dicee.models.complex.ComplEx.name" title="Link to this definition"></a></dt>
<dd><p>The name identifier for the ComplEx model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">score(head_ent_emb:</span> <span class="pre">torch.FloatTensor,</span> <span class="pre">rel_ent_emb:</span> <span class="pre">torch.FloatTensor,</span></span></dt>
<dd><blockquote>
<div><p>tail_ent_emb: torch.FloatTensor) -&gt; torch.FloatTensor</p>
</div></blockquote>
<p>Computes the score of a triple using the ComplEx scoring function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">k_vs_all_score(emb_h:</span> <span class="pre">torch.FloatTensor,</span> <span class="pre">emb_r:</span> <span class="pre">torch.FloatTensor,</span></span></dt>
<dd><blockquote>
<div><p>emb_E: torch.FloatTensor) -&gt; torch.FloatTensor</p>
</div></blockquote>
<p>Computes scores in a K-vs-All setting using complex-valued embeddings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dicee.models.complex.ComplEx.forward_k_vs_all">
<span class="sig-name descname"><span class="pre">forward_k_vs_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.LongTensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.FloatTensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#ComplEx.forward_k_vs_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dicee.models.complex.ComplEx.forward_k_vs_all" title="Link to this definition"></a></dt>
<dd><p>Performs a forward pass for K-vs-All scoring, returning scores for all entities.</p>
</dd></dl>

<p class="rubric">Notes</p>
<p>ComplEx is particularly suited for modeling asymmetric relations and has been
shown to perform well on various knowledge graph benchmarks. The use of complex
numbers allows the model to encode additional information compared to real-valued models.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dicee.models.complex.ComplEx.score">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_ent_emb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.FloatTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_ent_emb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.FloatTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_ent_emb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.FloatTensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.FloatTensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#ComplEx.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dicee.models.complex.ComplEx.score" title="Link to this definition"></a></dt>
<dd><p>Compute the scoring function for a given triple using complex-valued embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head_ent_emb</strong> (<em>torch.FloatTensor</em>) – The complex embedding of the head entity.</p></li>
<li><p><strong>rel_ent_emb</strong> (<em>torch.FloatTensor</em>) – The complex embedding of the relation.</p></li>
<li><p><strong>tail_ent_emb</strong> (<em>torch.FloatTensor</em>) – The complex embedding of the tail entity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of the triple calculated using the Hermitian dot product of complex embeddings.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.FloatTensor</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The scoring function exploits the complex vector space to model the interactions
between entities and relations. It involves element-wise multiplication and
summation of real and imaginary parts.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dicee.models.complex.ComplEx.k_vs_all_score">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k_vs_all_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb_h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.FloatTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emb_r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.FloatTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emb_E</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.FloatTensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.FloatTensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#ComplEx.k_vs_all_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dicee.models.complex.ComplEx.k_vs_all_score" title="Link to this definition"></a></dt>
<dd><p>Compute scores for a head entity and relation against all entities in a K-vs-All scenario.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>emb_h</strong> (<em>torch.FloatTensor</em>) – The complex embedding of the head entity.</p></li>
<li><p><strong>emb_r</strong> (<em>torch.FloatTensor</em>) – The complex embedding of the relation.</p></li>
<li><p><strong>emb_E</strong> (<em>torch.FloatTensor</em>) – The complex embeddings of all possible tail entities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scores for all possible triples formed with the given head entity and relation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.FloatTensor</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method is useful for tasks like link prediction where the model predicts
the likelihood of a relation between a given entity pair.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">forward_k_vs_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.LongTensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.FloatTensor</span></span></span><a class="reference internal" href="../../../../_modules/dicee/models/complex.html#ComplEx.forward_k_vs_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>Perform a forward pass for K-vs-all scoring using complex-valued embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.LongTensor</em>) – Tensor containing indices for head entities and relations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scores for all triples formed with the given head entities and relations against all entities.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.FloatTensor</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method is typically used in training and evaluation of the model in a
link prediction setting, where the goal is to rank all possible tail entities
for a given head entity and relation.</p>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../clifford/index.html" class="btn btn-neutral float-left" title="dicee.models.clifford" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../dualE/index.html" class="btn btn-neutral float-right" title="dicee.models.dualE" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Caglar Demir.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>